(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{va5E:function(e,t){var i={};!function(){var e={version:"0.7.4.0",isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e},isValue:function(e){return null!=e}};Object.keys||(Object.keys=function(e){var t=[];for(var i in e)t.push(i);return t});var t=Function,n={registerNamespace:{isPrototype:!1,func:t.registerNamespace},registerInterface:{isPrototype:!0,func:t.prototype.registerInterface},registerClass:{isPrototype:!0,func:t.prototype.registerClass},registerEnum:{isPrototype:!0,func:t.prototype.registerEnum}},r={};t.registerNamespace=function(e){},t.prototype.registerInterface=function(e){},t.prototype.registerEnum=function(e,t){for(var i in this.prototype)this[i]=this.prototype[i]},t.prototype.registerClass=function(e,t,i){var n=this;this.prototype.constructor=this,this.__baseType=t||Object,t&&(this.__basePrototypePending=!0,this.__setupBase=function(){!function(e){if(e.__basePrototypePending){var t=e.__baseType;for(var i in t.__basePrototypePending&&t.__setupBase(),t.prototype){var n=t.prototype[i];e.prototype[i]||(e.prototype[i]=n)}delete e.__basePrototypePending,delete e.__setupBase}}(n)},this.initializeBase=function(e,t){!function(e,t,i){e.__basePrototypePending&&e.__setupBase();i?e.__baseType.apply(t,i):e.__baseType.apply(t)}(n,e,t)},this.callBaseMethod=function(e,t,i){!function(e,t,i,n){var r=e.__baseType.prototype[i];n?r.apply(t,n):r.apply(t)}(n,e,t,i)})},e.Delegate=function(){},e.Delegate.registerClass("Delegate"),e.Delegate.empty=function(){},e.Delegate._contains=function(e,t,i){for(var n=0;n<e.length;n+=2)if(e[n]===t&&e[n+1]===i)return!0;return!1},e.Delegate._create=function(t){var i=function(){if(2==t.length)return t[1].apply(t[0],arguments);for(var i=t.concat(),n=0;n<i.length;n+=2)e.Delegate._contains(t,i[n],i[n+1])&&i[n+1].apply(i[n],arguments);return null};return i._targets=t,i},e.Delegate.create=function(t,i){return t?e.Delegate._create([t,i]):i},e.Delegate.combine=function(t,i){if(!t)return i._targets?i:e.Delegate.create(null,i);if(!i)return t._targets?t:e.Delegate.create(null,t);var n=t._targets?t._targets:[null,t],r=i._targets?i._targets:[null,i];return e.Delegate._create(n.concat(r))},e.Delegate.remove=function(t,i){if(!t||t===i)return null;if(!i)return t;var n,r=t._targets,a=null;i._targets?(a=i._targets[0],n=i._targets[1]):n=i;for(var o=0;o<r.length;o+=2)if(r[o]===a&&r[o+1]===n)return 2==r.length?null:(r.splice(o,2),e.Delegate._create(r));return t},e.IEnumerator=function(){},e.IEnumerator.prototype={get_current:null,moveNext:null,reset:null},e.IEnumerator.getEnumerator=function(t){return t?t.getEnumerator?t.getEnumerator():new e.ArrayEnumerator(t):null},e.IEnumerable=function(){},e.IEnumerable.prototype={getEnumerator:null},e.ArrayEnumerator=function(e){this._array=e,this._index=-1,this.current=null},e.ArrayEnumerator.prototype={moveNext:function(){return this._index++,this.current=this._array[this._index],this._index<this._array.length},reset:function(){this._index=-1,this.current=null}},e.IDisposable=function(){},e.IDisposable.prototype={dispose:null},e.StringBuilder=function(t){this._parts=e.isNullOrUndefined(t)?[]:[t],this.isEmpty=0==this._parts.length},e.StringBuilder.prototype={append:function(t){return e.isNullOrUndefined(t)||(this._parts.push(t),this.isEmpty=!1),this},appendLine:function(e){return this.append(e),this.append("\r\n"),this.isEmpty=!1,this},clear:function(){this._parts=[],this.isEmpty=!0},toString:function(e){return this._parts.join(e||"")}},e.StringBuilder.registerClass("StringBuilder"),e.EventArgs=function(){},e.EventArgs.registerClass("EventArgs"),e.EventArgs.Empty=new e.EventArgs,e.CancelEventArgs=function(){e.CancelEventArgs.initializeBase(this),this.cancel=!1},e.CancelEventArgs.registerClass("CancelEventArgs",e.EventArgs),e.Tuple=function(e,t,i){this.first=e,this.second=t,3==arguments.length&&(this.third=i)},e.Tuple.registerClass("Tuple"),t.registerNamespace("tab"),r.EscapingUtil=function(){},r.EscapingUtil.escapeHtml=function(e){var t=e||"";return t=(t=(t=(t=(t=(t=t.replace(new RegExp("&","g"),"&amp;")).replace(new RegExp("<","g"),"&lt;")).replace(new RegExp(">","g"),"&gt;")).replace(new RegExp('"',"g"),"&quot;")).replace(new RegExp("'","g"),"&#39;")).replace(new RegExp("/","g"),"&#47;")},r.WindowHelper=function(e){this._window=e},r.WindowHelper.get_windowSelf=function(){return window.self},r.WindowHelper.close=function(e){e.close()},r.WindowHelper.getOpener=function(e){return e.opener},r.WindowHelper.getLocation=function(e){return e.location},r.WindowHelper.getPathAndSearch=function(e){return e.location.pathname+e.location.search},r.WindowHelper.setLocationHref=function(e,t){e.location.href=t},r.WindowHelper.locationReplace=function(e,t){e.location.replace(t)},r.WindowHelper.open=function(e,t,i){return window.open(e,t,i)},r.WindowHelper.reload=function(e,t){e.location.reload(t)},r.WindowHelper.requestAnimationFrame=function(e){return r.WindowHelper._requestAnimationFrameFunc(e)},r.WindowHelper.cancelAnimationFrame=function(t){e.isValue(t)&&r.WindowHelper._cancelAnimationFrameFunc(t)},r.WindowHelper._setDefaultRequestAnimationFrameImpl=function(){var e=0;r.WindowHelper._requestAnimationFrameFunc=function(t){var i=(new Date).getTime(),n=Math.max(0,16-(i-e));return e=i+n,window.setTimeout((function(){t()}),n)}},r.WindowHelper.prototype={_window:null,get_pageXOffset:function(){return r.WindowHelper._pageXOffsetFunc(this._window)},get_pageYOffset:function(){return r.WindowHelper._pageYOffsetFunc(this._window)},get_clientWidth:function(){return r.WindowHelper._clientWidthFunc(this._window)},get_clientHeight:function(){return r.WindowHelper._clientHeightFunc(this._window)},get_innerWidth:function(){return r.WindowHelper._innerWidthFunc(this._window)},get_outerWidth:function(){return r.WindowHelper._outerWidthFunc(this._window)},get_innerHeight:function(){return r.WindowHelper._innerHeightFunc(this._window)},get_outerHeight:function(){return r.WindowHelper._outerHeightFunc(this._window)},get_screenLeft:function(){return r.WindowHelper._screenLeftFunc(this._window)},get_screenTop:function(){return r.WindowHelper._screenTopFunc(this._window)}},r.EscapingUtil.registerClass("tab.EscapingUtil"),r.WindowHelper.registerClass("tab.WindowHelper"),r.WindowHelper._innerWidthFunc=null,r.WindowHelper._innerHeightFunc=null,r.WindowHelper._clientWidthFunc=null,r.WindowHelper._clientHeightFunc=null,r.WindowHelper._pageXOffsetFunc=null,r.WindowHelper._pageYOffsetFunc=null,r.WindowHelper._screenLeftFunc=null,r.WindowHelper._screenTopFunc=null,r.WindowHelper._outerWidthFunc=null,r.WindowHelper._outerHeightFunc=null,r.WindowHelper._requestAnimationFrameFunc=null,r.WindowHelper._cancelAnimationFrameFunc=null,function(){"innerWidth"in window?r.WindowHelper._innerWidthFunc=function(e){return e.innerWidth}:r.WindowHelper._innerWidthFunc=function(e){return e.document.documentElement.offsetWidth},"outerWidth"in window?r.WindowHelper._outerWidthFunc=function(e){return e.outerWidth}:r.WindowHelper._outerWidthFunc=r.WindowHelper._innerWidthFunc,"innerHeight"in window?r.WindowHelper._innerHeightFunc=function(e){return e.innerHeight}:r.WindowHelper._innerHeightFunc=function(e){return e.document.documentElement.offsetHeight},"outerHeight"in window?r.WindowHelper._outerHeightFunc=function(e){return e.outerHeight}:r.WindowHelper._outerHeightFunc=r.WindowHelper._innerHeightFunc,"clientWidth"in window?r.WindowHelper._clientWidthFunc=function(e){return e.clientWidth}:r.WindowHelper._clientWidthFunc=function(e){return e.document.documentElement.clientWidth},"clientHeight"in window?r.WindowHelper._clientHeightFunc=function(e){return e.clientHeight}:r.WindowHelper._clientHeightFunc=function(e){return e.document.documentElement.clientHeight},e.isValue(window.self.pageXOffset)?r.WindowHelper._pageXOffsetFunc=function(e){return e.pageXOffset}:r.WindowHelper._pageXOffsetFunc=function(e){return e.document.documentElement.scrollLeft},e.isValue(window.self.pageYOffset)?r.WindowHelper._pageYOffsetFunc=function(e){return e.pageYOffset}:r.WindowHelper._pageYOffsetFunc=function(e){return e.document.documentElement.scrollTop},"screenLeft"in window?r.WindowHelper._screenLeftFunc=function(e){return e.screenLeft}:r.WindowHelper._screenLeftFunc=function(e){return e.screenX},"screenTop"in window?r.WindowHelper._screenTopFunc=function(e){return e.screenTop}:r.WindowHelper._screenTopFunc=function(e){return e.screenY};var t=["ms","moz","webkit","o"],i=null,n=null;"requestAnimationFrame"in window&&(i="requestAnimationFrame"),"cancelAnimationFrame"in window&&(n="cancelAnimationFrame");for(var a=0;a<t.length&&(null==i||null==n);++a){var o=t[a],s=o+"RequestAnimationFrame";null==i&&s in window&&(i=s),null==n&&((s=o+"CancelAnimationFrame")in window&&(n=s),(s=o+"CancelRequestAnimationFrame")in window&&(n=s))}null!=i?r.WindowHelper._requestAnimationFrameFunc=function(e){return window[i](e)}:r.WindowHelper._setDefaultRequestAnimationFrameImpl(),r.WindowHelper._cancelAnimationFrameFunc=null!=n?function(e){window[n](e)}:function(e){window.clearTimeout(e)}}(),t.registerNamespace("tab"),r.$create__SheetInfoImpl=function(e,t,i,n,r,a,o,s,l){var u={};return u.name=e,u.sheetType=t,u.index=i,u.size=n,u.workbook=r,u.url=a,u.isActive=o,u.isHidden=s,u.zoneId=l,u},r.$create__dashboardZoneInfo=function(e,t,i,n,r){var a={};return a._name=e,a._objectType=t,a._position=i,a._size=n,a._zoneId=r,a},r.$create__StoryPointInfoImpl=function(e,t,i,n,r,a){var o={};return o.caption=e,o.index=t,o.storyPointId=i,o.isActive=n,o.isUpdated=r,o.parentStoryImpl=a,o},r._ApiCommand=function(e,t,i,n){this._name=e,this._sourceId=t,this._handlerId=i,this._parameters=n},r._ApiCommand.parse=function(e){var t,i,n=e.indexOf(",");if(n<0)return t=e,new r._ApiCommand(t,null,null,null);t=e.substr(0,n);var a,o=e.substr(n+1);if((n=o.indexOf(","))<0)return i=o,new r._ApiCommand(t,i,null,null);i=o.substr(0,n);var s=o.substr(n+1);if((n=s.indexOf(","))<0)return a=s,new r._ApiCommand(t,i,a,null);a=s.substr(0,n);var l=s.substr(n+1);return r._ApiCommand.lastResponseMessage=e,"api.GetClientInfoCommand"===t&&(r._ApiCommand.lastClientInfoResponseMessage=e),new r._ApiCommand(t,i,a,l)},r._ApiCommand.prototype={_name:null,_handlerId:null,_sourceId:null,_parameters:null,get_name:function(){return this._name},get_handlerId:function(){return this._handlerId},get_sourceId:function(){return this._sourceId},get_parameters:function(){return this._parameters},get_isApiCommandName:function(){return!this.get_rawName().indexOf("api.",0)},get_rawName:function(){return this._name},serialize:function(){var t=[];t.push(this._name),t.push(this._sourceId),t.push(this._handlerId),e.isValue(this._parameters)&&t.push(this._parameters);var i=t.join(",");return r._ApiCommand.lastRequestMessage=i,i}},r._ApiServerResultParser=function(e){var t=JSON.parse(e);this._commandResult=t["api.commandResult"],this._commandData=t["api.commandData"]},r._ApiServerResultParser.prototype={_commandResult:null,_commandData:null,get_result:function(){return this._commandResult},get_data:function(){return this._commandData}},r._ApiServerNotification=function(e,t,i){this._workbookName=e,this._worksheetName=t,this._data=i},r._ApiServerNotification.deserialize=function(e){var t=JSON.parse(e),i=t["api.workbookName"],n=t["api.worksheetName"],a=t["api.commandData"];return new r._ApiServerNotification(i,n,a)},r._ApiServerNotification.prototype={_workbookName:null,_worksheetName:null,_data:null,get_workbookName:function(){return this._workbookName},get_worksheetName:function(){return this._worksheetName},get_data:function(){return this._data},serialize:function(){var e={};return e["api.workbookName"]=this._workbookName,e["api.worksheetName"]=this._worksheetName,e["api.commandData"]=this._data,JSON.stringify(e)}},r._CommandReturnHandler=function(e,t,i,n){this._commandName=e,this._successCallback=i,this._successCallbackTiming=t,this._errorCallback=n},r._CommandReturnHandler.prototype={_commandName:null,_successCallbackTiming:0,_successCallback:null,_errorCallback:null,get_commandName:function(){return this._commandName},get_successCallback:function(){return this._successCallback},get_successCallbackTiming:function(){return this._successCallbackTiming},get_errorCallback:function(){return this._errorCallback}},r._crossDomainMessageRouter=function(){this._handlers={},this._commandCallbacks={},this._customViewLoadCallbacks={},this._commandReturnAfterStateReadyQueues={},r._Utility.hasWindowAddEventListener()?window.addEventListener("message",this._getHandleCrossDomainMessageDelegate(),!1):r._Utility.hasDocumentAttachEvent()?(document.attachEvent("onmessage",this._getHandleCrossDomainMessageDelegate()),window.attachEvent("onmessage",this._getHandleCrossDomainMessageDelegate())):window.onmessage=this._getHandleCrossDomainMessageDelegate(),this._nextHandlerId=this._nextCommandId=0},r._crossDomainMessageRouter.prototype={_nextHandlerId:0,_nextCommandId:0,registerHandler:function(t){var i="handler"+this._nextHandlerId;if(e.isValue(t.get_handlerId())||e.isValue(this._handlers[t.get_handlerId()]))throw r._TableauException.createInternalError("Handler '"+t.get_handlerId()+"' is already registered.");this._nextHandlerId++,t.set_handlerId(i),this._handlers[i]=t,t.add_customViewsListLoad(e.Delegate.create(this,this._handleCustomViewsListLoad)),t.add_stateReadyForQuery(e.Delegate.create(this,this._handleStateReadyForQuery))},unregisterHandler:function(t){(e.isValue(t.get_handlerId())||e.isValue(this._handlers[t.get_handlerId()]))&&(delete this._handlers[t.get_handlerId()],t.remove_customViewsListLoad(e.Delegate.create(this,this._handleCustomViewsListLoad)),t.remove_stateReadyForQuery(e.Delegate.create(this,this._handleStateReadyForQuery)))},sendCommand:function(t,i,n){var a=t.get_iframe(),o=t.get_handlerId();if(r._Utility.hasWindowPostMessage()&&!e.isNullOrUndefined(a)&&!e.isNullOrUndefined(a.contentWindow)){var s="cmd"+this._nextCommandId;this._nextCommandId++;var l=this._commandCallbacks[o];e.isNullOrUndefined(l)&&(l={},this._commandCallbacks[o]=l),l[s]=n;var u=n.get_commandName();if("api.ShowCustomViewCommand"===u){var _=this._customViewLoadCallbacks[o];e.isNullOrUndefined(_)&&(_={},this._customViewLoadCallbacks[o]=_),_[s]=n}var c=null;e.isValue(i)&&(c=r.JsonUtil.toJson(i,!1,""));var m=new r._ApiCommand(u,s,o,c).serialize();r._Utility.isPostMessageSynchronous()?window.setTimeout((function(){a.contentWindow.postMessage(m,t.get_serverRoot())}),0):a.contentWindow.postMessage(m,t.get_serverRoot())}},_handleCustomViewsListLoad:function(t){var i=t.get_handlerId(),n=this._customViewLoadCallbacks[i];if(!e.isNullOrUndefined(n)){var r=n;for(var a in r){var o={key:a,value:r[a]}.value;e.isValue(o.get_successCallback())&&o.get_successCallback()(null)}delete this._customViewLoadCallbacks[i]}},_handleStateReadyForQuery:function(t){var i=this._commandReturnAfterStateReadyQueues[t.get_handlerId()];if(!r._Utility.isNullOrEmpty(i))for(;i.length>0;){var n=i.pop();e.isValue(n)&&n()}},_getHandleCrossDomainMessageDelegate:function(){return e.Delegate.create(this,(function(e){this._handleCrossDomainMessage(e)}))},_handleCrossDomainMessage:function(t){if(!e.isNullOrUndefined(t.data)){var i=r._ApiCommand.parse(t.data),n=i.get_rawName(),a=i.get_handlerId(),o=this._handlers[a];(e.isNullOrUndefined(o)||o.get_handlerId()!==i.get_handlerId())&&(o=new r._doNothingCrossDomainHandler),i.get_isApiCommandName()?"xdomainSourceId"===i.get_sourceId()?(o.handleEventNotification(i.get_name(),i.get_parameters()),"api.FirstVizSizeKnownEvent"===i.get_name()&&t.source.postMessage("tableau.bootstrap","*")):this._handleCrossDomainResponse(i):this._handleLegacyNotifications(n,t,o)}},_handleCrossDomainResponse:function(t){var i=this._commandCallbacks[t.get_handlerId()],n=e.isValue(i)?i[t.get_sourceId()]:null;if(!e.isNullOrUndefined(n)&&(delete i[t.get_sourceId()],t.get_name()===n.get_commandName())){var a=new r._ApiServerResultParser(t.get_parameters()),o=a.get_data();if("api.success"===a.get_result())switch(n.get_successCallbackTiming()){case 0:e.isValue(n.get_successCallback())&&n.get_successCallback()(o);break;case 1:var s=this._commandReturnAfterStateReadyQueues[t.get_handlerId()];e.isNullOrUndefined(s)&&(s=[],this._commandReturnAfterStateReadyQueues[t.get_handlerId()]=s),s.push((function(){e.isValue(n.get_successCallback())&&n.get_successCallback()(o)}));break;default:throw r._TableauException.createInternalError("Unknown timing value: "+n.get_successCallbackTiming())}else if(e.isValue(n.get_errorCallback())){var l="api.remotefailed"===a.get_result();n.get_errorCallback()(l,o)}}},_handleLegacyNotifications:function(e,t,i){"layoutInfoReq"===e?(r._VizManagerImpl._sendVizOffsets(),this._postLayoutInfo(t.source)):"tableau.completed"!==e&&"completed"!==e||i.handleVizLoad()},_postLayoutInfo:function(t){if(r._Utility.hasWindowPostMessage()){var i=new r.WindowHelper(window.self),n=e.isValue(i.get_innerWidth())?i.get_innerWidth():document.documentElement.offsetWidth,a=e.isValue(i.get_innerHeight())?i.get_innerHeight():document.documentElement.offsetHeight,o=e.isValue(i.get_pageXOffset())?i.get_pageXOffset():document.documentElement.scrollLeft,s=e.isValue(i.get_pageYOffset())?i.get_pageYOffset():document.documentElement.scrollTop,l=[];l.push("layoutInfoResp"),l.push(o),l.push(s),l.push(n),l.push(a),t.postMessage(l.join(","),"*")}}},r._doNothingCrossDomainHandler=function(){},r._doNothingCrossDomainHandler.prototype={_handlerId:null,add_customViewsListLoad:function(t){this.__customViewsListLoad=e.Delegate.combine(this.__customViewsListLoad,t)},remove_customViewsListLoad:function(t){this.__customViewsListLoad=e.Delegate.remove(this.__customViewsListLoad,t)},__customViewsListLoad:null,add_stateReadyForQuery:function(t){this.__stateReadyForQuery=e.Delegate.combine(this.__stateReadyForQuery,t)},remove_stateReadyForQuery:function(t){this.__stateReadyForQuery=e.Delegate.remove(this.__stateReadyForQuery,t)},__stateReadyForQuery:null,get_iframe:function(){return null},get_handlerId:function(){return this._handlerId},set_handlerId:function(e){return this._handlerId=e,e},get_serverRoot:function(){return"*"},handleVizLoad:function(){},handleEventNotification:function(e,t){},_silenceTheCompilerWarning:function(){this.__customViewsListLoad(null),this.__stateReadyForQuery(null)}},r.CrossDomainMessagingOptions=function(e,t){r._Param.verifyValue(e,"router"),r._Param.verifyValue(t,"handler"),this._router=e,this._handler=t},r.CrossDomainMessagingOptions.prototype={_router:null,_handler:null,get_router:function(){return this._router},get_handler:function(){return this._handler},sendCommand:function(e,t){this._router.sendCommand(this._handler,e,t)}},r._enums=function(){},r._enums._normalizePeriodType=function(t,n){var a=e.isValue(t)?t:"";return r._enums._normalizeEnum(a,n,i.PeriodType,!0)},r._enums._normalizeDateRangeType=function(t,n){var a=e.isValue(t)?t:"";return r._enums._normalizeEnum(a,n,i.DateRangeType,!0)},r._enums._normalizeFilterUpdateType=function(t,n){var a=e.isValue(t)?t:"";return r._enums._normalizeEnum(a,n,i.FilterUpdateType,!0)},r._enums._normalizeSelectionUpdateType=function(t,n){var a=e.isValue(t)?t:"";return r._enums._normalizeEnum(a,n,i.SelectionUpdateType,!0)},r._enums._isSelectionUpdateType=function(t){var n=e.isValue(t)?t.toString():"";return null!=r._enums._normalizeEnum(n,"",i.SelectionUpdateType,!1)},r._enums._normalizeNullOption=function(t,n){var a=e.isValue(t)?t:"";return r._enums._normalizeEnum(a,n,i.NullOption,!0)},r._enums._normalizeSheetSizeBehavior=function(t,n){var a=e.isValue(t)?t:"";return r._enums._normalizeEnum(a,n,i.SheetSizeBehavior,!0)},r._enums._normalizeTableauEventName=function(t){var n=e.isValue(t)?t:"";return r._enums._normalizeEnum(n,"",i.TableauEventName,!1)},r._enums._normalizeEnum=function(t,i,n,a){if(e.isValue(t)){var o=t.toString().toUpperCase(),s=n;for(var l in s){var u={key:l,value:s[l]};if(o===u.value.toString().toUpperCase())return u.value}}if(a)throw r._TableauException.createInvalidParameter(i);return null},r._ApiBootstrap=function(){},r._ApiBootstrap.initialize=function(){r._ApiObjectRegistry.registerCrossDomainMessageRouter((function(){return new r._crossDomainMessageRouter}))},r._ApiObjectRegistry=function(){},r._ApiObjectRegistry.registerCrossDomainMessageRouter=function(e){return r._ApiObjectRegistry._registerType("ICrossDomainMessageRouter",e)},r._ApiObjectRegistry.getCrossDomainMessageRouter=function(){return r._ApiObjectRegistry._getSingleton("ICrossDomainMessageRouter")},r._ApiObjectRegistry.disposeCrossDomainMessageRouter=function(){r._ApiObjectRegistry._clearSingletonInstance("ICrossDomainMessageRouter")},r._ApiObjectRegistry._registerType=function(t,i){e.isNullOrUndefined(r._ApiObjectRegistry._creationRegistry)&&(r._ApiObjectRegistry._creationRegistry={});var n=r._ApiObjectRegistry._creationRegistry[t];return r._ApiObjectRegistry._creationRegistry[t]=i,n},r._ApiObjectRegistry._createType=function(t){if(e.isNullOrUndefined(r._ApiObjectRegistry._creationRegistry))throw r._TableauException.createInternalError("No types registered");var i=r._ApiObjectRegistry._creationRegistry[t];if(e.isNullOrUndefined(i))throw r._TableauException.createInternalError("No creation function has been registered for interface type '"+t+"'.");return i()},r._ApiObjectRegistry._getSingleton=function(t){e.isNullOrUndefined(r._ApiObjectRegistry._singletonInstanceRegistry)&&(r._ApiObjectRegistry._singletonInstanceRegistry={});var i=r._ApiObjectRegistry._singletonInstanceRegistry[t];return e.isNullOrUndefined(i)&&(i=r._ApiObjectRegistry._createType(t),r._ApiObjectRegistry._singletonInstanceRegistry[t]=i),i},r._ApiObjectRegistry._clearSingletonInstance=function(t){if(e.isNullOrUndefined(r._ApiObjectRegistry._singletonInstanceRegistry))return null;var i=r._ApiObjectRegistry._singletonInstanceRegistry[t];return delete r._ApiObjectRegistry._singletonInstanceRegistry[t],i},r._CustomViewImpl=function(e,t,i){this._workbookImpl=e,this._name=t,this._messagingOptions=i,this._isPublic=!1,this._isDefault=!1,this._isStale=!1},r._CustomViewImpl._getAsync=function(e){var t=new r._Deferred;return t.resolve(e.get__customViewImpl().get__customView()),t.get_promise()},r._CustomViewImpl._createNew=function(t,i,n,a){var o=new r._CustomViewImpl(t,n.name,i);return o._isPublic=n.isPublic,o._url=n.url,o._ownerName=n.owner.friendlyName,o._isDefault=e.isValue(a)&&a===n.id,o._presModel=n,o},r._CustomViewImpl._saveNewAsync=function(t,i,n){var a=new r._Deferred,o={};o["api.customViewName"]=n;var s=r._CustomViewImpl._createCustomViewCommandReturnHandler("api.SaveNewCustomViewCommand",a,(function(n){r._CustomViewImpl._processCustomViewUpdate(t,i,n,!0);var o=null;e.isValue(t.get__updatedCustomViews())&&(o=t.get__updatedCustomViews().get_item(0)),a.resolve(o)}));return i.sendCommand(o,s),a.get_promise()},r._CustomViewImpl._showCustomViewAsync=function(t,i,n){var a=new r._Deferred,o={};e.isValue(n)&&(o["api.customViewParam"]=n);var s=r._CustomViewImpl._createCustomViewCommandReturnHandler("api.ShowCustomViewCommand",a,(function(e){var i=t.get_activeCustomView();a.resolve(i)}));return i.sendCommand(o,s),a.get_promise()},r._CustomViewImpl._makeCurrentCustomViewDefaultAsync=function(e,t){var i=new r._Deferred,n=r._CustomViewImpl._createCustomViewCommandReturnHandler("api.MakeCurrentCustomViewDefaultCommand",i,(function(t){var n=e.get_activeCustomView();i.resolve(n)}));return t.sendCommand({},n),i.get_promise()},r._CustomViewImpl._getCustomViewsAsync=function(e,t){var i=new r._Deferred,n=new r._CommandReturnHandler("api.FetchCustomViewsCommand",0,(function(n){r._CustomViewImpl._processCustomViews(e,t,n),i.resolve(e.get__customViews()._toApiCollection())}),(function(e,t){i.reject(r._TableauException.create("serverError",t))}));return t.sendCommand(null,n),i.get_promise()},r._CustomViewImpl._processCustomViews=function(e,t,i){r._CustomViewImpl._processCustomViewUpdate(e,t,i,!1)},r._CustomViewImpl._processCustomViewUpdate=function(t,i,n,a){a&&t.set__updatedCustomViews(new r._Collection),t.set__currentCustomView(null);var o=null;e.isValue(n.currentView)&&(o=n.currentView.name);var s=n.defaultCustomViewId;if(a&&e.isValue(n.newView)){var l=r._CustomViewImpl._createNew(t,i,n.newView,s);t.get__updatedCustomViews()._add(l.get__name(),l.get__customView())}if(t.set__removedCustomViews(t.get__customViews()),t.set__customViews(new r._Collection),e.isValue(n.customViews)){var u=n.customViews;if(u.length>0)for(var _=0;_<u.length;_++){var c=r._CustomViewImpl._createNew(t,i,u[_],s);t.get__customViews()._add(c.get__name(),c.get__customView()),t.get__removedCustomViews()._has(c.get__name())?t.get__removedCustomViews()._remove(c.get__name()):a&&(t.get__updatedCustomViews()._has(c.get__name())||t.get__updatedCustomViews()._add(c.get__name(),c.get__customView())),e.isValue(o)&&c.get__name()===o&&t.set__currentCustomView(c.get__customView())}}},r._CustomViewImpl._createCustomViewCommandReturnHandler=function(e,t,i){return new r._CommandReturnHandler(e,0,i,(function(e,i){t.reject(r._TableauException.create("serverError",i))}))},r._CustomViewImpl.prototype={_customView:null,_presModel:null,_workbookImpl:null,_messagingOptions:null,_name:null,_ownerName:null,_url:null,_isPublic:!1,_isDefault:!1,_isStale:!1,get__customView:function(){return null==this._customView&&(this._customView=new i.CustomView(this)),this._customView},get__workbook:function(){return this._workbookImpl.get_workbook()},get__url:function(){return this._url},get__name:function(){return this._name},set__name:function(e){if(this._isStale)throw r._TableauException.create("staleDataReference","Stale data");return this._name=e,e},get__ownerName:function(){return this._ownerName},get__advertised:function(){return this._isPublic},set__advertised:function(e){if(this._isStale)throw r._TableauException.create("staleDataReference","Stale data");return this._isPublic=e,e},get__isDefault:function(){return this._isDefault},saveAsync:function(){if(this._isStale||e.isNullOrUndefined(this._presModel))throw r._TableauException.create("staleDataReference","Stale data");this._presModel.isPublic=this._isPublic,this._presModel.name=this._name;var t=new r._Deferred,i={};i["api.customViewParam"]=this._presModel;var n=r._CustomViewImpl._createCustomViewCommandReturnHandler("api.UpdateCustomViewCommand",t,e.Delegate.create(this,(function(e){r._CustomViewImpl._processCustomViewUpdate(this._workbookImpl,this._messagingOptions,e,!0),t.resolve(this.get__customView())})));return this._messagingOptions.sendCommand(i,n),t.get_promise()},_removeAsync:function(){var t=new r._Deferred,i={};i["api.customViewParam"]=this._presModel;var n=r._CustomViewImpl._createCustomViewCommandReturnHandler("api.RemoveCustomViewCommand",t,e.Delegate.create(this,(function(e){this._isStale=!0,r._CustomViewImpl._processCustomViews(this._workbookImpl,this._messagingOptions,e),t.resolve(this.get__customView())})));return this._messagingOptions.sendCommand(i,n),t.get_promise()},_showAsync:function(){if(this._isStale||e.isNullOrUndefined(this._presModel))throw r._TableauException.create("staleDataReference","Stale data");return r._CustomViewImpl._showCustomViewAsync(this._workbookImpl,this._messagingOptions,this._presModel)},_isDifferent:function(e){return this._ownerName!==e._ownerName||this._url!==e._url||this._isPublic!==e._isPublic||this._isDefault!==e._isDefault}},r._DashboardImpl=function(e,t,i){this._worksheets$1=new r._Collection,this._dashboardObjects$1=new r._Collection,r._DashboardImpl.initializeBase(this,[e,t,i])},r._DashboardImpl.prototype={_dashboard$1:null,get_sheet:function(){return this.get_dashboard()},get_dashboard:function(){return null==this._dashboard$1&&(this._dashboard$1=new i.Dashboard(this)),this._dashboard$1},get_worksheets:function(){return this._worksheets$1},get_objects:function(){return this._dashboardObjects$1},_addObjects:function(t,n){this._dashboardObjects$1=new r._Collection,this._worksheets$1=new r._Collection;for(var a=0;a<t.length;a++){var o=t[a],s=null;if("worksheet"===t[a]._objectType){var l=o._name;if(e.isNullOrUndefined(l))continue;var u=this._worksheets$1.get__length(),_=r.SheetSizeFactory.createAutomatic(),c=n(l),m=e.isNullOrUndefined(c),h=m?"":c.getUrl(),d=r.$create__SheetInfoImpl(l,"worksheet",u,_,this.get_workbook(),h,!1,m,o._zoneId),p=new r._WorksheetImpl(d,this.get_workbookImpl(),this.get_messagingOptions(),this);s=p.get_worksheet(),this._worksheets$1._add(l,p.get_worksheet())}var f=new i.DashboardObject(o,this.get_dashboard(),s);this._dashboardObjects$1._add(a.toString(),f)}}},r._DataSourceImpl=function(e,t){this._fields=new r._Collection,r._Param.verifyString(e,"name"),this._name=e,this._isPrimary=t},r._DataSourceImpl.processDataSource=function(t){for(var n=new r._DataSourceImpl(t.name,t.isPrimary),a=t.fields||new Array(0),o=e.IEnumerator.getEnumerator(a);o.moveNext();){var s=o.current,l=new i.Field(n.get_dataSource(),s.name,s.role,s.aggregation);n.addField(l)}return n},r._DataSourceImpl.processDataSourcesForWorksheet=function(t){for(var i=new r._Collection,n=null,a=e.IEnumerator.getEnumerator(t.dataSources);a.moveNext();){var o=a.current,s=r._DataSourceImpl.processDataSource(o);o.isPrimary?n=s:i._add(o.name,s.get_dataSource())}return e.isValue(n)&&i._addToFirst(n.get_name(),n.get_dataSource()),i},r._DataSourceImpl.prototype={_name:null,_isPrimary:!1,_dataSource:null,get_dataSource:function(){return null==this._dataSource&&(this._dataSource=new i.DataSource(this)),this._dataSource},get_name:function(){return this._name},get_fields:function(){return this._fields},get_isPrimary:function(){return this._isPrimary},addField:function(e){this._fields._add(e.getName(),e)}},r._deferredUtil=function(){},r._deferredUtil.coerceToTrustedPromise=function(t){var n;if(t instanceof i.Promise)n=t;else if(e.isValue(t)&&"function"==typeof t.valueOf&&(t=t.valueOf()),r._deferredUtil.isPromise(t)){var a=new r._DeferredImpl;t.then(e.Delegate.create(a,a.resolve),e.Delegate.create(a,a.reject)),n=a.get_promise()}else n=r._deferredUtil.resolved(t);return n},r._deferredUtil.reject=function(e){return r._deferredUtil.coerceToTrustedPromise(e).then((function(e){return r._deferredUtil.rejected(e)}),null)},r._deferredUtil.resolved=function(t){return new r._PromiseImpl((function(i,n){try{return r._deferredUtil.coerceToTrustedPromise(e.isValue(i)?i(t):t)}catch(a){return r._deferredUtil.rejected(a)}}))},r._deferredUtil.rejected=function(t){return new r._PromiseImpl((function(i,n){try{return e.isValue(n)?r._deferredUtil.coerceToTrustedPromise(n(t)):r._deferredUtil.rejected(t)}catch(a){return r._deferredUtil.rejected(a)}}))},r._deferredUtil.isPromise=function(t){return e.isValue(t)&&"function"==typeof t.then},r._CollectionImpl=function(){this._items=[],this._itemMap={}},r._CollectionImpl.prototype={get__length:function(){return this._items.length},get__rawArray:function(){return this._items},_get:function(t){var i=this._ensureValidKey(t);if(e.isValue(this._itemMap[i]))return this._itemMap[i]},_has:function(t){return e.isValue(this._get(t))},_add:function(e,t){this._verifyKeyAndItemParameters(e,t);var i=this._ensureValidKey(e);this._items.push(t),this._itemMap[i]=t},_addToFirst:function(e,t){this._verifyKeyAndItemParameters(e,t);var i=this._ensureValidKey(e);this._items.unshift(t),this._itemMap[i]=t},_remove:function(t){var i=this._ensureValidKey(t);if(e.isValue(this._itemMap[i])){var n=this._itemMap[i];delete this._itemMap[i];for(var r=0;r<this._items.length;r++)if(this._items[r]===n){this._items.splice(r,1);break}}},_toApiCollection:function(){var t=this._items.concat();return t.get=e.Delegate.create(this,(function(e){return this._get(e)})),t.has=e.Delegate.create(this,(function(e){return this._has(e)})),t},_verifyUniqueKeyParameter:function(e){if(r._Utility.isNullOrEmpty(e))throw new Error("Null key");if(this._has(e))throw new Error("Duplicate key '"+e+"'")},_verifyKeyAndItemParameters:function(t,i){if(this._verifyUniqueKeyParameter(t),e.isNullOrUndefined(i))throw new Error("Null item")},_ensureValidKey:function(e){return"_"+e},get_item:function(e){return this._items[e]}},r._DeferredImpl=function(){this._listeners=[],this._promise=new r._PromiseImpl(e.Delegate.create(this,this.then)),this._thenFunc=e.Delegate.create(this,this._preResolutionThen),this._resolveFunc=e.Delegate.create(this,this._transitionToFulfilled)},r._DeferredImpl.prototype={_promise:null,_thenFunc:null,_resolveFunc:null,get_promise:function(){return this._promise},all:function(e){var t=new r._DeferredImpl,i=e.length,n=i,a=[];if(!i)return t.resolve(a),t.get_promise();for(var o=function(e,i){r._deferredUtil.coerceToTrustedPromise(e).then((function(e){return a[i]=e,--n||t.resolve(a),null}),(function(e){return t.reject(e),null}))},s=0;s<i;s++)o(e[s],s);return t.get_promise()},then:function(e,t){return this._thenFunc(e,t)},resolve:function(e){return this._resolveFunc(e)},reject:function(e){return this._resolveFunc(r._deferredUtil.rejected(e))},_preResolutionThen:function(t,i){var n=new r._DeferredImpl;return this._listeners.push((function(r){r.then(t,i).then(e.Delegate.create(n,n.resolve),e.Delegate.create(n,n.reject))})),n.get_promise()},_transitionToFulfilled:function(e){var t=r._deferredUtil.coerceToTrustedPromise(e);this._thenFunc=t.then,this._resolveFunc=r._deferredUtil.coerceToTrustedPromise;for(var i=0;i<this._listeners.length;i++){(0,this._listeners[i])(t)}return this._listeners=null,t}},r._PromiseImpl=function(e){this.then=e},r._PromiseImpl.prototype={then:null,always:function(e){return this.then(e,e)},otherwise:function(e){return this.then(null,e)}},r._markImpl=function(t){if(this._collection=new r._Collection,r._jQueryShim.isArray(t))for(var n=t,a=0;a<n.length;a++){var o=n[a];if(!e.isValue(o.fieldName))throw r._TableauException.createInvalidParameter("pair.fieldName");if(!e.isValue(o.value))throw r._TableauException.createInvalidParameter("pair.value");var s=new i.Pair(o.fieldName,o.value);this._collection._add(s.fieldName,s)}else this._tupleId=t},r._markImpl._processSelectedMarks=function(t){var n=new r._Collection;if(e.isNullOrUndefined(t)||r._Utility.isNullOrEmpty(t.marks))return n;for(var a=e.IEnumerator.getEnumerator(t.marks);a.moveNext();){var o=a.current,s=o.tupleId,l=new i.Mark(s);n._add(s.toString(),l);for(var u=e.IEnumerator.getEnumerator(o.pairs);u.moveNext();){var _=u.current,c=r._Utility.convertRawValue(_.value,_.valueDataType),m=new i.Pair(_.fieldName,c);m.formattedValue=_.formattedValue,l._impl.get__pairs()._has(m.fieldName)||l._impl._addPair(m)}}return n},r._markImpl.prototype={_clonedPairs:null,_tupleId:0,get__pairs:function(){return this._collection},get__tupleId:function(){return this._tupleId},get__clonedPairs:function(){return null==this._clonedPairs&&(this._clonedPairs=this._collection._toApiCollection()),this._clonedPairs},_addPair:function(e){this._collection._add(e.fieldName,e)}},r._Param=function(){},r._Param.verifyString=function(t,i){if(e.isNullOrUndefined(t)||!t.length)throw r._TableauException.createInternalStringArgumentException(i)},r._Param.verifyValue=function(t,i){if(e.isNullOrUndefined(t))throw r._TableauException.createInternalNullArgumentException(i)},r._parameterImpl=function(t){if(this._name=t.name,this._currentValue=r._Utility.getDataValue(t.currentValue),this._dataType=t.dataType,this._allowableValuesType=t.allowableValuesType,e.isValue(t.allowableValues)&&"list"===this._allowableValuesType){this._allowableValues=[];for(var i=e.IEnumerator.getEnumerator(t.allowableValues);i.moveNext();){var n=i.current;this._allowableValues.push(r._Utility.getDataValue(n))}}"range"===this._allowableValuesType&&(this._minValue=r._Utility.getDataValue(t.minValue),this._maxValue=r._Utility.getDataValue(t.maxValue),this._stepSize=t.stepSize,("date"===this._dataType||"datetime"===this._dataType)&&e.isValue(this._stepSize)&&e.isValue(t.dateStepPeriod)&&(this._dateStepPeriod=t.dateStepPeriod))},r._parameterImpl.prototype={_parameter:null,_name:null,_currentValue:null,_dataType:null,_allowableValuesType:null,_allowableValues:null,_minValue:null,_maxValue:null,_stepSize:null,_dateStepPeriod:null,get__parameter:function(){return null==this._parameter&&(this._parameter=new i.Parameter(this)),this._parameter},get__name:function(){return this._name},get__currentValue:function(){return this._currentValue},get__dataType:function(){return this._dataType},get__allowableValuesType:function(){return this._allowableValuesType},get__allowableValues:function(){return this._allowableValues},get__minValue:function(){return this._minValue},get__maxValue:function(){return this._maxValue},get__stepSize:function(){return this._stepSize},get__dateStepPeriod:function(){return this._dateStepPeriod}},r._SheetImpl=function(e,t,i){r._Param.verifyValue(e,"sheetInfoImpl"),r._Param.verifyValue(t,"workbookImpl"),r._Param.verifyValue(i,"messagingOptions"),this._name=e.name,this._index=e.index,this._isActive=e.isActive,this._isHidden=e.isHidden,this._sheetType=e.sheetType,this._size=e.size,this._url=e.url,this._workbookImpl=t,this._messagingOptions=i,this._zoneId=e.zoneId},r._SheetImpl._convertValueToIntIfValid=function(t){return e.isValue(t)?r._Utility.toInt(t):t},r._SheetImpl._normalizeSheetSize=function(t){var i=r._enums._normalizeSheetSizeBehavior(t.behavior,"size.behavior"),n=t.minSize;e.isValue(n)&&(n=r.$create_Size(r._SheetImpl._convertValueToIntIfValid(t.minSize.width),r._SheetImpl._convertValueToIntIfValid(t.minSize.height)));var a=t.maxSize;return e.isValue(a)&&(a=r.$create_Size(r._SheetImpl._convertValueToIntIfValid(t.maxSize.width),r._SheetImpl._convertValueToIntIfValid(t.maxSize.height))),r.$create_SheetSize(i,n,a)},r._SheetImpl.prototype={_name:null,_index:0,_isActive:!1,_isHidden:!1,_sheetType:null,_size:null,_url:null,_workbookImpl:null,_messagingOptions:null,_parentStoryPointImpl:null,_zoneId:0,get_name:function(){return this._name},get_index:function(){return this._index},get_workbookImpl:function(){return this._workbookImpl},get_workbook:function(){return this._workbookImpl.get_workbook()},get_url:function(){if(this._isHidden)throw r._TableauException.createNoUrlForHiddenWorksheet();return this._url},get_size:function(){return this._size},get_isHidden:function(){return this._isHidden},get_isActive:function(){return this._isActive},set_isActive:function(e){return this._isActive=e,e},get_isDashboard:function(){return"dashboard"===this._sheetType},get_sheetType:function(){return this._sheetType},get_parentStoryPoint:function(){return e.isValue(this._parentStoryPointImpl)?this._parentStoryPointImpl.get_storyPoint():null},get_parentStoryPointImpl:function(){return this._parentStoryPointImpl},set_parentStoryPointImpl:function(e){if("story"===this._sheetType)throw r._TableauException.createInternalError("A story cannot be a child of another story.");return this._parentStoryPointImpl=e,e},get_zoneId:function(){return this._zoneId},get_messagingOptions:function(){return this._messagingOptions},changeSizeAsync:function(t){if(t=r._SheetImpl._normalizeSheetSize(t),"worksheet"===this._sheetType&&"automatic"!==t.behavior)throw r._TableauException.createInvalidSizeBehaviorOnWorksheet();var i=new r._Deferred;if(this._size.behavior===t.behavior&&"automatic"===t.behavior)return i.resolve(t),i.get_promise();var n=this._processSheetSize(t),a={};a["api.setSheetSizeName"]=this._name,a["api.minWidth"]=n["api.minWidth"],a["api.minHeight"]=n["api.minHeight"],a["api.maxWidth"]=n["api.maxWidth"],a["api.maxHeight"]=n["api.maxHeight"];var o=new r._CommandReturnHandler("api.SetSheetSizeCommand",1,e.Delegate.create(this,(function(t){this.get_workbookImpl()._update(e.Delegate.create(this,(function(){var e=this.get_workbookImpl().get_publishedSheets()._get(this.get_name()).getSize();i.resolve(e)})))})),(function(e,t){i.reject(r._TableauException.createServerError(t))}));return this.sendCommand(a,o),i.get_promise()},sendCommand:function(e,t){this._messagingOptions.sendCommand(e,t)},_processSheetSize:function(t){var i=null;if(e.isNullOrUndefined(t)||e.isNullOrUndefined(t.behavior)||"automatic"!==t.behavior&&e.isNullOrUndefined(t.minSize)&&e.isNullOrUndefined(t.maxSize))throw r._TableauException.createInvalidSheetSizeParam();var n=0,a=0,o=0,s=0,l={"api.minWidth":0,"api.minHeight":0,"api.maxWidth":0,"api.maxHeight":0};if("automatic"===t.behavior)i=r.$create_SheetSize("automatic",void 0,void 0);else if("atmost"===t.behavior){if(e.isNullOrUndefined(t.maxSize)||e.isNullOrUndefined(t.maxSize.width)||e.isNullOrUndefined(t.maxSize.height))throw r._TableauException.createMissingMaxSize();if(t.maxSize.width<0||t.maxSize.height<0)throw r._TableauException.createInvalidSizeValue();l["api.maxWidth"]=t.maxSize.width,l["api.maxHeight"]=t.maxSize.height,i=r.$create_SheetSize("atmost",void 0,t.maxSize)}else if("atleast"===t.behavior){if(e.isNullOrUndefined(t.minSize)||e.isNullOrUndefined(t.minSize.width)||e.isNullOrUndefined(t.minSize.height))throw r._TableauException.createMissingMinSize();if(t.minSize.width<0||t.minSize.height<0)throw r._TableauException.createInvalidSizeValue();l["api.minWidth"]=t.minSize.width,l["api.minHeight"]=t.minSize.height,i=r.$create_SheetSize("atleast",t.minSize,void 0)}else if("range"===t.behavior){if(e.isNullOrUndefined(t.minSize)||e.isNullOrUndefined(t.maxSize)||e.isNullOrUndefined(t.minSize.width)||e.isNullOrUndefined(t.maxSize.width)||e.isNullOrUndefined(t.minSize.height)||e.isNullOrUndefined(t.maxSize.height))throw r._TableauException.createMissingMinMaxSize();if(t.minSize.width<0||t.minSize.height<0||t.maxSize.width<0||t.maxSize.height<0||t.minSize.width>t.maxSize.width||t.minSize.height>t.maxSize.height)throw r._TableauException.createInvalidRangeSize();l["api.minWidth"]=t.minSize.width,l["api.minHeight"]=t.minSize.height,l["api.maxWidth"]=t.maxSize.width,l["api.maxHeight"]=t.maxSize.height,i=r.$create_SheetSize("range",t.minSize,t.maxSize)}else if("exactly"===t.behavior){if(e.isValue(t.minSize)&&e.isValue(t.maxSize)&&e.isValue(t.minSize.width)&&e.isValue(t.maxSize.width)&&e.isValue(t.minSize.height)&&e.isValue(t.maxSize.height)){if(n=t.minSize.width,a=t.minSize.height,o=t.maxSize.width,s=t.maxSize.height,n!==o||a!==s)throw r._TableauException.createSizeConflictForExactly()}else e.isValue(t.minSize)&&e.isValue(t.minSize.width)&&e.isValue(t.minSize.height)?(o=n=t.minSize.width,s=a=t.minSize.height):e.isValue(t.maxSize)&&e.isValue(t.maxSize.width)&&e.isValue(t.maxSize.height)&&(n=o=t.maxSize.width,a=s=t.maxSize.height);l["api.minWidth"]=n,l["api.minHeight"]=a,l["api.maxWidth"]=o,l["api.maxHeight"]=s,i=r.$create_SheetSize("exactly",r.$create_Size(n,a),r.$create_Size(o,s))}return this._size=i,l}},r._StoryImpl=function(e,t,i,n,a){r._StoryImpl.initializeBase(this,[e,t,i]),r._Param.verifyValue(n,"storyPm"),r._Param.verifyValue(a,"findSheetFunc"),this._findSheetFunc$1=a,this.update(n)},r._StoryImpl.prototype={_activeStoryPointImpl$1:null,_findSheetFunc$1:null,_story$1:null,_storyPointsInfo$1:null,add_activeStoryPointChange:function(t){this.__activeStoryPointChange$1=e.Delegate.combine(this.__activeStoryPointChange$1,t)},remove_activeStoryPointChange:function(t){this.__activeStoryPointChange$1=e.Delegate.remove(this.__activeStoryPointChange$1,t)},__activeStoryPointChange$1:null,get_activeStoryPointImpl:function(){return this._activeStoryPointImpl$1},get_sheet:function(){return this.get_story()},get_story:function(){return null==this._story$1&&(this._story$1=new i.Story(this)),this._story$1},get_storyPointsInfo:function(){return this._storyPointsInfo$1},update:function(t){var n=null,a=null;this._storyPointsInfo$1=this._storyPointsInfo$1||new Array(t.storyPoints.length);for(var o=0;o<t.storyPoints.length;o++){var s=t.storyPoints[o],l=s.caption,u=o===t.activeStoryPointIndex,_=r.$create__StoryPointInfoImpl(l,o,s.storyPointId,u,s.isUpdated,this);if(e.isNullOrUndefined(this._storyPointsInfo$1[o]))this._storyPointsInfo$1[o]=new i.StoryPointInfo(_);else if(this._storyPointsInfo$1[o]._impl.storyPointId===_.storyPointId){var c=this._storyPointsInfo$1[o]._impl;c.caption=_.caption,c.index=_.index,c.isActive=u,c.isUpdated=_.isUpdated}else this._storyPointsInfo$1[o]=new i.StoryPointInfo(_);u&&(n=s.containedSheetInfo,a=_)}var m=this._storyPointsInfo$1.length-t.storyPoints.length;this._storyPointsInfo$1.splice(t.storyPoints.length,m);var h=e.isNullOrUndefined(this._activeStoryPointImpl$1)||this._activeStoryPointImpl$1.get_storyPointId()!==a.storyPointId;e.isValue(this._activeStoryPointImpl$1)&&h&&this._activeStoryPointImpl$1.set_isActive(!1);var d=this._activeStoryPointImpl$1;if(h){var p=r._StoryPointImpl.createContainedSheet(n,this.get_workbookImpl(),this.get_messagingOptions(),this._findSheetFunc$1);this._activeStoryPointImpl$1=new r._StoryPointImpl(a,p)}else this._activeStoryPointImpl$1.set_isActive(a.isActive),this._activeStoryPointImpl$1.set_isUpdated(a.isUpdated);h&&e.isValue(d)&&this._raiseActiveStoryPointChange$1(this._storyPointsInfo$1[d.get_index()],this._activeStoryPointImpl$1.get_storyPoint())},activatePreviousStoryPointAsync:function(){return this._activatePreviousNextStoryPointAsync$1("api.ActivatePreviousStoryPoint")},activateNextStoryPointAsync:function(){return this._activatePreviousNextStoryPointAsync$1("api.ActivateNextStoryPoint")},activateStoryPointAsync:function(t){var i=new r._Deferred;if(t<0||t>=this._storyPointsInfo$1.length)throw r._TableauException.createIndexOutOfRange(t);var n=this.get_activeStoryPointImpl(),a={};a["api.storyPointIndex"]=t;var o=new r._CommandReturnHandler("api.ActivateStoryPoint",0,e.Delegate.create(this,(function(e){var t=e;this._updateActiveState$1(n,t),i.resolve(this._activeStoryPointImpl$1.get_storyPoint())})),(function(e,t){i.reject(r._TableauException.createServerError(t))}));return this.sendCommand(a,o),i.get_promise()},revertStoryPointAsync:function(t){if((t=t||this._activeStoryPointImpl$1.get_index())<0||t>=this._storyPointsInfo$1.length)throw r._TableauException.createIndexOutOfRange(t);var i=new r._Deferred,n={};n["api.storyPointIndex"]=t;var a=new r._CommandReturnHandler("api.RevertStoryPoint",0,e.Delegate.create(this,(function(e){var n=e;this._updateStoryPointInfo$1(t,n),i.resolve(this._storyPointsInfo$1[t])})),(function(e,t){i.reject(r._TableauException.createServerError(t))}));return this.sendCommand(n,a),i.get_promise()},_activatePreviousNextStoryPointAsync$1:function(t){if("api.ActivatePreviousStoryPoint"!==t&&"api.ActivateNextStoryPoint"!==t)throw r._TableauException.createInternalError("commandName '"+t+"' is invalid.");var i=new r._Deferred,n=this.get_activeStoryPointImpl(),a=new r._CommandReturnHandler(t,0,e.Delegate.create(this,(function(e){var t=e;this._updateActiveState$1(n,t),i.resolve(this._activeStoryPointImpl$1.get_storyPoint())})),(function(e,t){i.reject(r._TableauException.createServerError(t))}));return this.sendCommand({},a),i.get_promise()},_updateStoryPointInfo$1:function(e,t){var i=this._storyPointsInfo$1[e]._impl;if(i.storyPointId!==t.storyPointId)throw r._TableauException.createInternalError("We should not be updating a story point where the IDs don't match. Existing storyPointID="+i.storyPointId+", newStoryPointID="+t.storyPointId);i.caption=t.caption,i.isUpdated=t.isUpdated,t.storyPointId===this._activeStoryPointImpl$1.get_storyPointId()&&this._activeStoryPointImpl$1.set_isUpdated(t.isUpdated)},_updateActiveState$1:function(e,t){var i=t.index;if(e.get_index()!==i){var n=this._storyPointsInfo$1[e.get_index()],a=this._storyPointsInfo$1[i]._impl,o=r._StoryPointImpl.createContainedSheet(t.containedSheetInfo,this.get_workbookImpl(),this.get_messagingOptions(),this._findSheetFunc$1);a.isActive=!0,this._activeStoryPointImpl$1=new r._StoryPointImpl(a,o),e.set_isActive(!1),n._impl.isActive=!1,this._raiseActiveStoryPointChange$1(n,this._activeStoryPointImpl$1.get_storyPoint())}},_raiseActiveStoryPointChange$1:function(e,t){null!=this.__activeStoryPointChange$1&&this.__activeStoryPointChange$1(e,t)}},r._StoryPointImpl=function(t,i){if(this._isActive=t.isActive,this._isUpdated=t.isUpdated,this._caption=t.caption,this._index=t.index,this._parentStoryImpl=t.parentStoryImpl,this._storyPointId=t.storyPointId,this._containedSheetImpl=i,e.isValue(i)&&(this._containedSheetImpl.set_parentStoryPointImpl(this),"dashboard"===i.get_sheetType()))for(var n=this._containedSheetImpl,r=0;r<n.get_worksheets().get__length();r++){n.get_worksheets().get_item(r)._impl.set_parentStoryPointImpl(this)}},r._StoryPointImpl.createContainedSheet=function(t,i,n,a){var o=t.sheetType,s=r.SheetSizeFactory.createAutomatic(),l=a(t.name),u=e.isNullOrUndefined(l),_=u?"":l.getUrl(),c=r.$create__SheetInfoImpl(t.name,o,-1,s,i.get_workbook(),_,!1,u,t.zoneId);if("worksheet"===t.sheetType){return new r._WorksheetImpl(c,i,n,null)}if("dashboard"===t.sheetType){var m=new r._DashboardImpl(c,i,n),h=r._WorkbookImpl._createDashboardZones(t.dashboardZones);return m._addObjects(h,a),m}throw"story"===t.sheetType?r._TableauException.createInternalError("Cannot have a story embedded within another story."):r._TableauException.createInternalError("Unknown sheet type '"+t.sheetType+"'")},r._StoryPointImpl.prototype={_caption:null,_index:0,_isActive:!1,_isUpdated:!1,_containedSheetImpl:null,_parentStoryImpl:null,_storyPoint:null,_storyPointId:0,get_caption:function(){return this._caption},get_containedSheetImpl:function(){return this._containedSheetImpl},get_index:function(){return this._index},get_isActive:function(){return this._isActive},set_isActive:function(e){return this._isActive=e,e},get_isUpdated:function(){return this._isUpdated},set_isUpdated:function(e){return this._isUpdated=e,e},get_parentStoryImpl:function(){return this._parentStoryImpl},get_storyPoint:function(){return null==this._storyPoint&&(this._storyPoint=new i.StoryPoint(this)),this._storyPoint},get_storyPointId:function(){return this._storyPointId},_toInfoImpl:function(){return r.$create__StoryPointInfoImpl(this._caption,this._index,this._storyPointId,this._isActive,this._isUpdated,this._parentStoryImpl)}},r.StoryPointInfoImplUtil=function(){},r.StoryPointInfoImplUtil.clone=function(e){return r.$create__StoryPointInfoImpl(e.caption,e.index,e.storyPointId,e.isActive,e.isUpdated,e.parentStoryImpl)},r._TableauException=function(){},r._TableauException.create=function(e,t){var i=new Error(t);return i.tableauSoftwareErrorCode=e,i},r._TableauException.createInternalError=function(t){return e.isValue(t)?r._TableauException.create("internalError","Internal error. Please contact Tableau support with the following information: "+t):r._TableauException.create("internalError","Internal error. Please contact Tableau support")},r._TableauException.createInternalNullArgumentException=function(e){return r._TableauException.createInternalError("Null/undefined argument '"+e+"'.")},r._TableauException.createInternalStringArgumentException=function(e){return r._TableauException.createInternalError("Invalid string argument '"+e+"'.")},r._TableauException.createServerError=function(e){return r._TableauException.create("serverError",e)},r._TableauException.createNotActiveSheet=function(){return r._TableauException.create("notActiveSheet","Operation not allowed on non-active sheet")},r._TableauException.createInvalidCustomViewName=function(e){return r._TableauException.create("invalidCustomViewName","Invalid custom view name: "+e)},r._TableauException.createInvalidParameter=function(e){return r._TableauException.create("invalidParameter","Invalid parameter: "+e)},r._TableauException.createInvalidFilterFieldNameOrValue=function(e){return r._TableauException.create("invalidFilterFieldNameOrValue","Invalid filter field name or value: "+e)},r._TableauException.createInvalidDateParameter=function(e){return r._TableauException.create("invalidDateParameter","Invalid date parameter: "+e)},r._TableauException.createNullOrEmptyParameter=function(e){return r._TableauException.create("nullOrEmptyParameter","Parameter cannot be null or empty: "+e)},r._TableauException.createMissingMaxSize=function(){return r._TableauException.create("missingMaxSize","Missing maxSize for SheetSizeBehavior.ATMOST")},r._TableauException.createMissingMinSize=function(){return r._TableauException.create("missingMinSize","Missing minSize for SheetSizeBehavior.ATLEAST")},r._TableauException.createMissingMinMaxSize=function(){return r._TableauException.create("missingMinMaxSize","Missing minSize or maxSize for SheetSizeBehavior.RANGE")},r._TableauException.createInvalidRangeSize=function(){return r._TableauException.create("invalidSize","Missing minSize or maxSize for SheetSizeBehavior.RANGE")},r._TableauException.createInvalidSizeValue=function(){return r._TableauException.create("invalidSize","Size value cannot be less than zero")},r._TableauException.createInvalidSheetSizeParam=function(){return r._TableauException.create("invalidSize","Invalid sheet size parameter")},r._TableauException.createSizeConflictForExactly=function(){return r._TableauException.create("invalidSize","Conflicting size values for SheetSizeBehavior.EXACTLY")},r._TableauException.createInvalidSizeBehaviorOnWorksheet=function(){return r._TableauException.create("invalidSizeBehaviorOnWorksheet","Only SheetSizeBehavior.AUTOMATIC is allowed on Worksheets")},r._TableauException.createNoUrlForHiddenWorksheet=function(){return r._TableauException.create("noUrlForHiddenWorksheet","Hidden worksheets do not have a URL.")},r._TableauException._createInvalidAggregationFieldName=function(e){return r._TableauException.create("invalidAggregationFieldName","Invalid aggregation type for field '"+e+"'")},r._TableauException.createIndexOutOfRange=function(e){return r._TableauException.create("indexOutOfRange","Index '"+e+"' is out of range.")},r._TableauException.createUnsupportedEventName=function(e){return r._TableauException.create("unsupportedEventName","Unsupported event '"+e+"'.")},r._TableauException.createBrowserNotCapable=function(){return r._TableauException.create("browserNotCapable","This browser is incapable of supporting the Tableau JavaScript API.")},r._Utility=function(){},r._Utility.hasOwnProperty=function(e,t){return e.hasOwnProperty(t)},r._Utility.isNullOrEmpty=function(t){return e.isNullOrUndefined(t)||(t.length||0)<=0},r._Utility.isString=function(e){return"string"==typeof e},r._Utility.isNumber=function(e){return"number"==typeof e},r._Utility.isDate=function(e){return"object"==typeof e&&e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},r._Utility.isDateValid=function(e){return!isNaN(e.getTime())},r._Utility.indexOf=function(t,i,n){if(e.isValue(Array.prototype.indexOf))return t.indexOf(i,n);n=n||0;var r=t.length;if(r>0)for(var a=n;a<r;a++)if(t[a]===i)return a;return-1},r._Utility.contains=function(e,t,i){return r._Utility.indexOf(e,t,i)>=0},r._Utility.getTopmostWindow=function(){for(var t=window.self;e.isValue(t.parent)&&t.parent!==t;)t=t.parent;return t},r._Utility.toInt=function(e){return r._Utility.isNumber(e)?e:parseInt(e.toString(),10)},r._Utility.hasClass=function(t,i){var n=new RegExp("[\\n\\t\\r]","g");return e.isValue(t)&&(" "+t.className+" ").replace(n," ").indexOf(" "+i+" ")>-1},r._Utility.findParentWithClassName=function(t,i,n){var a=e.isValue(t)?t.parentNode:null;for(n=n||document.body;null!=a;){if(r._Utility.hasClass(a,i))return a;a=a===n?null:a.parentNode}return a},r._Utility.hasJsonParse=function(){return e.isValue(window.JSON)&&e.isValue(window.JSON.parse)},r._Utility.hasWindowPostMessage=function(){return e.isValue(window.postMessage)},r._Utility.isPostMessageSynchronous=function(){if(r._Utility.isIE()){var e=new RegExp("(msie) ([\\w.]+)").exec(window.navigator.userAgent.toLowerCase())[2]||"0";return parseInt(e,10)<=8}return!1},r._Utility.hasDocumentAttachEvent=function(){return e.isValue(document.attachEvent)},r._Utility.hasWindowAddEventListener=function(){return e.isValue(window.addEventListener)},r._Utility.isElementOfTag=function(t,i){return e.isValue(t)&&1===t.nodeType&&t.tagName.toLowerCase()===i.toLowerCase()},r._Utility.elementToString=function(t){var i=new e.StringBuilder;if(i.append(t.tagName.toLowerCase()),r._Utility.isNullOrEmpty(t.id)||i.append("#").append(t.id),!r._Utility.isNullOrEmpty(t.className)){var n=t.className.split(" ");i.append(".").append(n.join("."))}return i.toString()},r._Utility.tableauGCS=function(t){return e.isValue(window.getComputedStyle)?window.getComputedStyle(t):t.currentStyle},r._Utility.isIE=function(){return window.navigator.userAgent.indexOf("MSIE")>-1&&e.isNullOrUndefined(window.opera)},r._Utility.isSafari=function(){var e=window.navigator.userAgent,t=e.indexOf("Chrome")>=0;return e.indexOf("Safari")>=0&&!t},r._Utility.mobileDetect=function(){var e=window.navigator.userAgent;return-1!==e.indexOf("iPad")||(-1!==e.indexOf("Android")||-1!==e.indexOf("AppleWebKit")&&-1!==e.indexOf("Mobile"))},r._Utility.elementOffset=function(e){var t,i=(t=e.getBoundingClientRect()).top,n=t.left,a=new r.WindowHelper(window.self),o=window.document.documentElement,s=n+a.get_pageXOffset()-o.clientLeft,l=i+a.get_pageYOffset()-o.clientTop;return r.$create_Point(s,l)},r._Utility.convertRawValue=function(t,i){if(e.isNullOrUndefined(t))return null;switch(i){case"bool":return t;case"date":return new Date(t);case"number":return null==t?Number.NaN:t;case"string":default:return t}},r._Utility.getDataValue=function(t){return e.isNullOrUndefined(t)?r.$create_DataValue(null,null,null):r.$create_DataValue(r._Utility.convertRawValue(t.value,t.type),t.formattedValue,t.aliasedValue)},r._Utility.serializeDateForServer=function(t){var i="";e.isValue(t)&&r._Utility.isDate(t)&&(i=t.getUTCFullYear()+"-"+(t.getUTCMonth()+1)+"-"+t.getUTCDate()+" "+t.getUTCHours()+":"+t.getUTCMinutes()+":"+t.getUTCSeconds());return i},r._Utility.computeContentSize=function(e){var t=r._Utility._getComputedStyle(e),i=parseFloat(t.paddingLeft),n=parseFloat(t.paddingTop),a=parseFloat(t.paddingRight),o=parseFloat(t.paddingBottom),s=e.clientWidth-Math.round(i+a),l=e.clientHeight-Math.round(n+o);return r.$create_Size(s,l)},r._Utility._getComputedStyle=function(t){return e.isValue(window.getComputedStyle)?e.isValue(t.ownerDocument.defaultView.opener)?t.ownerDocument.defaultView.getComputedStyle(t,null):window.getComputedStyle(t,null):e.isValue(t.currentStyle)?t.currentStyle:t.style},r.VizImpl=function(t,i,n,a,o){if(!r._Utility.hasWindowPostMessage()||!r._Utility.hasJsonParse())throw r._TableauException.createBrowserNotCapable();this._messagingOptions=new r.CrossDomainMessagingOptions(t,this),this._viz=i,(e.isNullOrUndefined(n)||1!==n.nodeType)&&(n=document.body),this._parameters=new r._VizParameters(n,a,o),e.isValue(o)&&(this._onFirstInteractiveCallback=o.onFirstInteractive,this._onFirstVizSizeKnownCallback=o.onFirstVizSizeKnown)},r.VizImpl.prototype={_workbookTabSwitchHandler:null,_viz:null,_iframe:null,_parameters:null,_initialAvailableSize:null,_instanceId:null,_workbookImpl:null,_onFirstInteractiveCallback:null,_onFirstVizSizeKnownCallback:null,_onFirstInteractiveAlreadyCalled:!1,_areTabsHidden:!1,_isToolbarHidden:!1,_areAutomaticUpdatesPaused:!1,_messagingOptions:null,_vizSize:null,_windowResizeHandler:null,_initializingWorkbookImpl:!1,add_customViewsListLoad:function(t){this.__customViewsListLoad=e.Delegate.combine(this.__customViewsListLoad,t)},remove_customViewsListLoad:function(t){this.__customViewsListLoad=e.Delegate.remove(this.__customViewsListLoad,t)},__customViewsListLoad:null,add_stateReadyForQuery:function(t){this.__stateReadyForQuery=e.Delegate.combine(this.__stateReadyForQuery,t)},remove_stateReadyForQuery:function(t){this.__stateReadyForQuery=e.Delegate.remove(this.__stateReadyForQuery,t)},__stateReadyForQuery:null,add__marksSelection:function(t){this.__marksSelection=e.Delegate.combine(this.__marksSelection,t)},remove__marksSelection:function(t){this.__marksSelection=e.Delegate.remove(this.__marksSelection,t)},__marksSelection:null,add__filterChange:function(t){this.__filterChange=e.Delegate.combine(this.__filterChange,t)},remove__filterChange:function(t){this.__filterChange=e.Delegate.remove(this.__filterChange,t)},__filterChange:null,add__parameterValueChange:function(t){this.__parameterValueChange=e.Delegate.combine(this.__parameterValueChange,t)},remove__parameterValueChange:function(t){this.__parameterValueChange=e.Delegate.remove(this.__parameterValueChange,t)},__parameterValueChange:null,add__customViewLoad:function(t){this.__customViewLoad=e.Delegate.combine(this.__customViewLoad,t)},remove__customViewLoad:function(t){this.__customViewLoad=e.Delegate.remove(this.__customViewLoad,t)},__customViewLoad:null,add__customViewSave:function(t){this.__customViewSave=e.Delegate.combine(this.__customViewSave,t)},remove__customViewSave:function(t){this.__customViewSave=e.Delegate.remove(this.__customViewSave,t)},__customViewSave:null,add__customViewRemove:function(t){this.__customViewRemove=e.Delegate.combine(this.__customViewRemove,t)},remove__customViewRemove:function(t){this.__customViewRemove=e.Delegate.remove(this.__customViewRemove,t)},__customViewRemove:null,add__customViewSetDefault:function(t){this.__customViewSetDefault=e.Delegate.combine(this.__customViewSetDefault,t)},remove__customViewSetDefault:function(t){this.__customViewSetDefault=e.Delegate.remove(this.__customViewSetDefault,t)},__customViewSetDefault:null,add__tabSwitch:function(t){this.__tabSwitch=e.Delegate.combine(this.__tabSwitch,t)},remove__tabSwitch:function(t){this.__tabSwitch=e.Delegate.remove(this.__tabSwitch,t)},__tabSwitch:null,add__storyPointSwitch:function(t){this.__storyPointSwitch=e.Delegate.combine(this.__storyPointSwitch,t)},remove__storyPointSwitch:function(t){this.__storyPointSwitch=e.Delegate.remove(this.__storyPointSwitch,t)},__storyPointSwitch:null,add__vizResize:function(t){this.__vizResize=e.Delegate.combine(this.__vizResize,t)},remove__vizResize:function(t){this.__vizResize=e.Delegate.remove(this.__vizResize,t)},__vizResize:null,get_handlerId:function(){return this._parameters.handlerId},set_handlerId:function(e){return this._parameters.handlerId=e,e},get_iframe:function(){return this._iframe},get_instanceId:function(){return this._instanceId},get_serverRoot:function(){return this._parameters.serverRoot},get__viz:function(){return this._viz},get__areTabsHidden:function(){return this._areTabsHidden},get__isToolbarHidden:function(){return this._isToolbarHidden},get__isHidden:function(){return"none"===this._iframe.style.display},get__parentElement:function(){return this._parameters.parentElement},get__url:function(){return this._parameters.get_baseUrl()},get__workbook:function(){return this._workbookImpl.get_workbook()},get__workbookImpl:function(){return this._workbookImpl},get__areAutomaticUpdatesPaused:function(){return this._areAutomaticUpdatesPaused},get__vizSize:function(){return this._vizSize},getCurrentUrlAsync:function(){var e=new r._Deferred,t=new r._CommandReturnHandler("api.GetCurrentUrlCommand",0,(function(t){e.resolve(t)}),(function(t,i){e.reject(r._TableauException.createInternalError(i))}));return this._sendCommand(null,t),e.get_promise()},handleVizLoad:function(){this._sendVizOffset(),e.isNullOrUndefined(this._workbookImpl)?this._workbookImpl=new r._WorkbookImpl(this,this._messagingOptions,e.Delegate.create(this,(function(){this._onWorkbookInteractive()}))):this._initializingWorkbookImpl||this._workbookImpl._update(e.Delegate.create(this,(function(){this._onWorkbookInteractive()})))},_calculateFrameSize:function(e){var t,i,n,a,o=this._vizSize.chromeHeight,s=this._vizSize.sheetSize,l=0,u=0;if("exactly"===s.behavior)l=s.maxSize.width,u=s.maxSize.height+o;else switch(s.behavior){case"range":t=s.minSize.width,i=s.maxSize.width,n=s.minSize.height+o,a=s.maxSize.height+o,l=Math.max(t,Math.min(i,e.width)),u=Math.max(n,Math.min(a,e.height));break;case"atleast":t=s.minSize.width,n=s.minSize.height+o,l=Math.max(t,e.width),u=Math.max(n,e.height);break;case"atmost":i=s.maxSize.width,a=s.maxSize.height+o,l=Math.min(i,e.width),u=Math.min(a,e.height);break;case"automatic":l=e.width,u=Math.max(e.height,o);break;default:throw r._TableauException.createInternalError("Unknown SheetSizeBehavior for viz: "+s.behavior)}return r.$create_Size(l,u)},_getNewFrameSize:function(){var t;return e.isValue(this._initialAvailableSize)?(t=this._initialAvailableSize,this._initialAvailableSize=null):t=r._Utility.computeContentSize(this.get__parentElement()),this._raiseVizResizeEvent(t),this._calculateFrameSize(t)},_refreshSize:function(){var e=this._getNewFrameSize();this._setFrameSize(e.width+"px",e.height+"px");for(var t=0;t<10;t++){var i=this._getNewFrameSize();if(JSON.stringify(e)===JSON.stringify(i))return;e=i,this._setFrameSize(e.width+"px",e.height+"px")}throw r._TableauException.create("maxVizResizeAttempts","Viz resize limit hit. The calculated iframe size did not stabilize after 10 resizes.")},handleEventNotification:function(t,i){var n=r._ApiServerNotification.deserialize(i);if("api.FirstVizSizeKnownEvent"===t){var a=JSON.parse(n.get_data());this._handleInitialVizSize(a)}else if("api.VizInteractiveEvent"===t)this._instanceId=n.get_data(),e.isValue(this._workbookImpl)&&this._workbookImpl.get_name()===n.get_workbookName()&&this._onWorkbookInteractive(),this._raiseStateReadyForQuery();else if("api.MarksSelectionChangedEvent"===t){if(null!=this.__marksSelection&&this._workbookImpl.get_name()===n.get_workbookName()){var o=null;if((s=this._workbookImpl.get_activeSheetImpl()).get_name()===n.get_worksheetName())o=s;else if(s.get_isDashboard()){o=s.get_worksheets()._get(n.get_worksheetName())._impl}e.isValue(o)&&(o.set_selectedMarks(null),this.__marksSelection(new r.MarksEvent("marksselection",this._viz,o)))}}else if("api.FilterChangedEvent"===t){if(null!=this.__filterChange&&this._workbookImpl.get_name()===n.get_workbookName()){var s;o=null;if((s=this._workbookImpl.get_activeSheetImpl()).get_name()===n.get_worksheetName())o=s;else if(s.get_isDashboard()){o=s.get_worksheets()._get(n.get_worksheetName())._impl}if(e.isValue(o)){var l=JSON.parse(n.get_data()),u=l[0],_=l[1];this.__filterChange(new r.FilterEvent("filterchange",this._viz,o,u,_))}}}else if("api.ParameterChangedEvent"===t){if(null!=this.__parameterValueChange&&this._workbookImpl.get_name()===n.get_workbookName()){this._workbookImpl.set__lastChangedParameterImpl(null);var c=n.get_data();this._raiseParameterValueChange(c)}}else if("api.CustomViewsListLoadedEvent"===t){var m=JSON.parse(n.get_data()),h=e.Delegate.create(this,(function(){r._CustomViewImpl._processCustomViews(this._workbookImpl,this._messagingOptions,m)})),d=e.Delegate.create(this,(function(){this._raiseCustomViewsListLoad(),null==this.__customViewLoad||m.customViewLoaded||this._raiseCustomViewLoad(this._workbookImpl.get_activeCustomView())}));e.isNullOrUndefined(this._workbookImpl)?(this._initializingWorkbookImpl=!0,this._workbookImpl=new r._WorkbookImpl(this,this._messagingOptions,e.Delegate.create(this,(function(){h(),this._onWorkbookInteractive(d),this._initializingWorkbookImpl=!1})))):(h(),this._ensureCalledAfterFirstInteractive(d))}else if("api.CustomViewUpdatedEvent"===t){m=JSON.parse(n.get_data());if(e.isNullOrUndefined(this._workbookImpl)&&(this._workbookImpl=new r._WorkbookImpl(this,this._messagingOptions,e.Delegate.create(this,(function(){this._onWorkbookInteractive()})))),e.isValue(this._workbookImpl)&&r._CustomViewImpl._processCustomViewUpdate(this._workbookImpl,this._messagingOptions,m,!0),null!=this.__customViewSave)for(var p=0,f=(v=this._workbookImpl.get__updatedCustomViews()._toApiCollection()).length;p<f;p++)this._raiseCustomViewSave(v[p])}else if("api.CustomViewRemovedEvent"===t){if(null!=this.__customViewRemove){var g=this._workbookImpl.get__removedCustomViews()._toApiCollection();for(p=0,f=g.length;p<f;p++)this._raiseCustomViewRemove(g[p])}}else if("api.CustomViewSetDefaultEvent"===t){m=JSON.parse(n.get_data());if(e.isValue(this._workbookImpl)&&r._CustomViewImpl._processCustomViews(this._workbookImpl,this._messagingOptions,m),null!=this.__customViewSetDefault){var v;for(p=0,f=(v=this._workbookImpl.get__updatedCustomViews()._toApiCollection()).length;p<f;p++)this._raiseCustomViewSetDefault(v[p])}}else if("api.TabSwitchEvent"===t)this._workbookImpl._update(e.Delegate.create(this,(function(){if(e.isValue(this._workbookTabSwitchHandler)&&this._workbookTabSwitchHandler(),this._workbookImpl.get_name()===n.get_workbookName()){var t=n.get_worksheetName(),i=n.get_data();this._raiseTabSwitch(t,i)}this._onWorkbookInteractive()})));else if("api.StorytellingStateChangedEvent"===t){var w=this._workbookImpl.get_activeSheetImpl();"story"===w.get_sheetType()&&w.update(JSON.parse(n.get_data()))}},addEventListener:function(e,t){var i=r._enums._normalizeTableauEventName(e);if("marksselection"===i)this.add__marksSelection(t);else if("parametervaluechange"===i)this.add__parameterValueChange(t);else if("filterchange"===i)this.add__filterChange(t);else if("customviewload"===i)this.add__customViewLoad(t);else if("customviewsave"===i)this.add__customViewSave(t);else if("customviewremove"===i)this.add__customViewRemove(t);else if("customviewsetdefault"===i)this.add__customViewSetDefault(t);else if("tabswitch"===i)this.add__tabSwitch(t);else if("storypointswitch"===i)this.add__storyPointSwitch(t);else{if("vizresize"!==i)throw r._TableauException.createUnsupportedEventName(e);this.add__vizResize(t)}},removeEventListener:function(e,t){var i=r._enums._normalizeTableauEventName(e);if("marksselection"===i)this.remove__marksSelection(t);else if("parametervaluechange"===i)this.remove__parameterValueChange(t);else if("filterchange"===i)this.remove__filterChange(t);else if("customviewload"===i)this.remove__customViewLoad(t);else if("customviewsave"===i)this.remove__customViewSave(t);else if("customviewremove"===i)this.remove__customViewRemove(t);else if("customviewsetdefault"===i)this.remove__customViewSetDefault(t);else if("tabswitch"===i)this.remove__tabSwitch(t);else if("storypointswitch"===i)this.remove__storyPointSwitch(t);else{if("vizresize"!==i)throw r._TableauException.createUnsupportedEventName(e);this.remove__vizResize(t)}},_dispose:function(){e.isValue(this._iframe)&&(this._iframe.parentNode.removeChild(this._iframe),this._iframe=null),r._VizManagerImpl._unregisterViz(this._viz),this._messagingOptions.get_router().unregisterHandler(this),this._removeWindowResizeHandler()},_show:function(){this._iframe.style.display="block",this._iframe.style.visibility="visible"},_hide:function(){this._iframe.style.display="none"},_makeInvisible:function(){this._iframe.style.visibility="hidden"},_showExportImageDialog:function(){this._invokeCommand("showExportImageDialog")},_showExportDataDialog:function(e){var t=this._verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard(e);this._invokeCommand("showExportDataDialog",t)},_showExportCrossTabDialog:function(e){var t=this._verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard(e);this._invokeCommand("showExportCrosstabDialog",t)},_showExportPDFDialog:function(){this._invokeCommand("showExportPDFDialog")},_revertAllAsync:function(){var e=new r._Deferred,t=new r._CommandReturnHandler("api.RevertAllCommand",1,(function(t){e.resolve()}),(function(t,i){e.reject(r._TableauException.createServerError(i))}));return this._sendCommand(null,t),e.get_promise()},_refreshDataAsync:function(){var e=new r._Deferred,t=new r._CommandReturnHandler("api.RefreshDataCommand",1,(function(t){e.resolve()}),(function(t,i){e.reject(r._TableauException.createServerError(i))}));return this._sendCommand(null,t),e.get_promise()},_showShareDialog:function(){this._invokeCommand("showShareDialog")},_showDownloadWorkbookDialog:function(){if(!this.get__workbookImpl().get_isDownloadAllowed())throw r._TableauException.create("downloadWorkbookNotAllowed","Download workbook is not allowed");this._invokeCommand("showDownloadWorkbookDialog")},_pauseAutomaticUpdatesAsync:function(){return this._invokeAutomaticUpdatesCommandAsync("pauseAutomaticUpdates")},_resumeAutomaticUpdatesAsync:function(){return this._invokeAutomaticUpdatesCommandAsync("resumeAutomaticUpdates")},_toggleAutomaticUpdatesAsync:function(){return this._invokeAutomaticUpdatesCommandAsync("toggleAutomaticUpdates")},_setFrameSize:function(e,t){this._parameters.width=e,this._parameters.height=t,this._iframe.style.width=this._parameters.width,this._iframe.style.height=this._parameters.height},_setFrameSizeAndUpdate:function(e,t){this._raiseVizResizeEvent(r.$create_Size(-1,-1)),this._setFrameSize(e,t),this._workbookImpl._updateActiveSheetAsync()},_setAreAutomaticUpdatesPaused:function(e){this._areAutomaticUpdatesPaused=e},_contentRootElement:function(){return this._parameters.parentElement},_create:function(){try{r._VizManagerImpl._registerViz(this._viz)}catch(e){throw this._dispose(),e}this._parameters.fixedSize?(this._iframe=this._createIframe(),this._show()):(this._initialAvailableSize=r._Utility.computeContentSize(this.get__parentElement()),this._initialAvailableSize.width&&this._initialAvailableSize.height||(this._initialAvailableSize=r.$create_Size(800,600)),this._iframe=this._createIframe(),this._makeInvisible()),r._Utility.hasWindowPostMessage()||(r._Utility.isIE()?this._iframe.onreadystatechange=this._getOnCheckForDoneDelegate():this._iframe.onload=this._getOnCheckForDoneDelegate()),this._isToolbarHidden=!this._parameters.toolbar,this._areTabsHidden=!this._parameters.tabs,this._messagingOptions.get_router().registerHandler(this),this._iframe.src=this._parameters.get_url()},_sendVizOffset:function(){if(r._Utility.hasWindowPostMessage()&&!e.isNullOrUndefined(this._iframe)&&e.isValue(this._iframe.contentWindow)){var t=r._Utility.elementOffset(this._iframe),i=[];i.push("vizOffsetResp"),i.push(t.x),i.push(t.y),this._iframe.contentWindow.postMessage(i.join(","),"*")}},_sendCommand:function(e,t){this._messagingOptions.sendCommand(e,t)},_raiseParameterValueChange:function(e){null!=this.__parameterValueChange&&this.__parameterValueChange(new r.ParameterEvent("parametervaluechange",this._viz,e))},_raiseCustomViewLoad:function(t){null!=this.__customViewLoad&&this.__customViewLoad(new r.CustomViewEvent("customviewload",this._viz,e.isValue(t)?t._impl:null))},_raiseCustomViewSave:function(e){null!=this.__customViewSave&&this.__customViewSave(new r.CustomViewEvent("customviewsave",this._viz,e._impl))},_raiseCustomViewRemove:function(e){null!=this.__customViewRemove&&this.__customViewRemove(new r.CustomViewEvent("customviewremove",this._viz,e._impl))},_raiseCustomViewSetDefault:function(e){null!=this.__customViewSetDefault&&this.__customViewSetDefault(new r.CustomViewEvent("customviewsetdefault",this._viz,e._impl))},_raiseTabSwitch:function(e,t){null!=this.__tabSwitch&&this.__tabSwitch(new r.TabSwitchEvent("tabswitch",this._viz,e,t))},raiseStoryPointSwitch:function(e,t){null!=this.__storyPointSwitch&&this.__storyPointSwitch(new r.StoryPointSwitchEvent("storypointswitch",this._viz,e,t))},_raiseStateReadyForQuery:function(){null!=this.__stateReadyForQuery&&this.__stateReadyForQuery(this)},_raiseCustomViewsListLoad:function(){null!=this.__customViewsListLoad&&this.__customViewsListLoad(this)},_raiseVizResizeEvent:function(e){null!=this.__vizResize&&this.__vizResize(new r.VizResizeEvent("vizresize",this._viz,e))},_verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard:function(t){if(e.isNullOrUndefined(t))return null;var i=this._workbookImpl._findActiveSheetOrSheetWithinActiveDashboard(t);if(e.isNullOrUndefined(i))throw r._TableauException.createNotActiveSheet();return i.get_name()},_invokeAutomaticUpdatesCommandAsync:function(t){if("pauseAutomaticUpdates"!==t&&"resumeAutomaticUpdates"!==t&&"toggleAutomaticUpdates"!==t)throw r._TableauException.createInternalError(null);var i={};i["api.invokeCommandName"]=t;var n=new r._Deferred,a=new r._CommandReturnHandler("api.InvokeCommandCommand",0,e.Delegate.create(this,(function(t){var i=t;e.isValue(i)&&e.isValue(i.isAutoUpdate)&&(this._areAutomaticUpdatesPaused=!i.isAutoUpdate),n.resolve(this._areAutomaticUpdatesPaused)})),(function(e,t){n.reject(r._TableauException.createServerError(t))}));return this._sendCommand(i,a),n.get_promise()},_invokeCommand:function(t,i){if("showExportImageDialog"!==t&&"showExportDataDialog"!==t&&"showExportCrosstabDialog"!==t&&"showExportPDFDialog"!==t&&"showShareDialog"!==t&&"showDownloadWorkbookDialog"!==t)throw r._TableauException.createInternalError(null);var n={};n["api.invokeCommandName"]=t,e.isValue(i)&&(n["api.invokeCommandParam"]=i);var a=new r._CommandReturnHandler("api.InvokeCommandCommand",0,null,null);this._sendCommand(n,a)},_onWorkbookInteractive:function(t){if(!this._onFirstInteractiveAlreadyCalled){var i=this._onFirstInteractiveCallback;window.setTimeout(e.Delegate.create(this,(function(){e.isValue(i)&&i(new r.TableauEvent("firstinteractive",this._viz)),e.isValue(t)&&t()})),0),this._onFirstInteractiveAlreadyCalled=!0}this._raiseStateReadyForQuery()},_ensureCalledAfterFirstInteractive:function(t){var i=new Date,n=null;(n=e.Delegate.create(this,(function(){var e=new Date;if(this._onFirstInteractiveAlreadyCalled)t();else{if(e-i>3e5)throw r._TableauException.createInternalError("Timed out while waiting for the viz to become interactive");window.setTimeout(n,10)}})))()},_checkForDone:function(){r._Utility.isIE()?"complete"===this._iframe.readyState&&this.handleVizLoad():this.handleVizLoad()},_onCheckForDone:function(){window.setTimeout(e.Delegate.create(this,this._checkForDone),3e3)},_createIframe:function(){if(e.isNullOrUndefined(this._contentRootElement()))return null;var t=document.createElement("IFrame");return t.frameBorder="0",t.setAttribute("allowTransparency","true"),t.marginHeight="0",t.marginWidth="0",t.style.display="block",this._parameters.fixedSize?(t.style.width=this._parameters.width,t.style.height=this._parameters.height):(t.style.width="1px",t.style.height="1px",t.setAttribute("scrolling","no")),r._Utility.isSafari()&&t.addEventListener("mousewheel",e.Delegate.create(this,this._onIframeMouseWheel),!1),this._contentRootElement().appendChild(t),t},_onIframeMouseWheel:function(e){},_getOnCheckForDoneDelegate:function(){return e.Delegate.create(this,(function(e){this._onCheckForDone()}))},_handleInitialVizSize:function(t){var i=r.SheetSizeFactory.fromSizeConstraints(t.sizeConstraints);this._vizSize=r.$create_VizSize(i,t.chromeHeight),e.isValue(this._onFirstVizSizeKnownCallback)&&this._onFirstVizSizeKnownCallback(new r.FirstVizSizeKnownEvent("firstvizsizeknown",this._viz,this._vizSize)),this._parameters.fixedSize||(this._refreshSize(),this._addWindowResizeHandler(),this._show())},_removeWindowResizeHandler:function(){e.isNullOrUndefined(this._windowResizeHandler)||(r._Utility.hasWindowAddEventListener()?window.removeEventListener("resize",this._windowResizeHandler,!1):window.self.detachEvent("onresize",this._windowResizeHandler),this._windowResizeHandler=null)},_addWindowResizeHandler:function(){e.isValue(this._windowResizeHandler)||(this._windowResizeHandler=e.Delegate.create(this,(function(){this._refreshSize()})),r._Utility.hasWindowAddEventListener()?window.addEventListener("resize",this._windowResizeHandler,!1):window.self.attachEvent("onresize",this._windowResizeHandler))}},r._VizManagerImpl=function(){},r._VizManagerImpl.get__clonedVizs=function(){return r._VizManagerImpl._vizs.concat()},r._VizManagerImpl._registerViz=function(e){r._VizManagerImpl._verifyVizNotAlreadyParented(e),r._VizManagerImpl._vizs.push(e)},r._VizManagerImpl._unregisterViz=function(e){for(var t=0,i=r._VizManagerImpl._vizs.length;t<i;t++)if(r._VizManagerImpl._vizs[t]===e){r._VizManagerImpl._vizs.splice(t,1);break}},r._VizManagerImpl._sendVizOffsets=function(){for(var e=0,t=r._VizManagerImpl._vizs.length;e<t;e++)r._VizManagerImpl._vizs[e]._impl._sendVizOffset()},r._VizManagerImpl._verifyVizNotAlreadyParented=function(e){for(var t=e.getParentElement(),i=0,n=r._VizManagerImpl._vizs.length;i<n;i++)if(r._VizManagerImpl._vizs[i].getParentElement()===t){var a="Another viz is already present in element '"+r._Utility.elementToString(t)+"'.";throw r._TableauException.create("vizAlreadyInManager",a)}},r._VizParameters=function(t,i,n){if(e.isNullOrUndefined(t)||e.isNullOrUndefined(i))throw r._TableauException.create("noUrlOrParentElementNotFound","URL is empty or Parent element not found");e.isNullOrUndefined(n)&&((n={}).hideTabs=!1,n.hideToolbar=!1,n.onFirstInteractive=null),e.isValue(n.height)||e.isValue(n.width)?(this.fixedSize=!0,r._Utility.isNumber(n.height)&&(n.height=n.height.toString()+"px"),r._Utility.isNumber(n.width)&&(n.width=n.width.toString()+"px"),this.height=e.isValue(n.height)?n.height.toString():null,this.width=e.isValue(n.width)?n.width.toString():null):this.fixedSize=!1,this.tabs=!n.hideTabs,this.toolbar=!n.hideToolbar,this.parentElement=t,this._createOptions=n,this.toolBarPosition=n.toolbarPosition;var a=i.split("?");this._urlFromApi=a[0],2===a.length?this.userSuppliedParameters=a[1]:this.userSuppliedParameters="";var o=new RegExp(".*?[^/:]/","").exec(this._urlFromApi);if(e.isNullOrUndefined(o)||-1===o[0].toLowerCase().indexOf("http://")&&-1===o[0].toLowerCase().indexOf("https://"))throw r._TableauException.create("invalidUrl","Invalid url");this.host_url=o[0].toLowerCase(),this.name=this._urlFromApi.replace(o[0],""),this.name=this.name.replace("views/",""),this.serverRoot=decodeURIComponent(this.host_url)},r._VizParameters.prototype={name:"",host_url:null,tabs:!1,toolbar:!1,toolBarPosition:null,handlerId:null,width:null,height:null,serverRoot:null,parentElement:null,userSuppliedParameters:null,fixedSize:!1,_urlFromApi:null,_createOptions:null,get_url:function(){return this._constructUrl()},get_baseUrl:function(){return this._urlFromApi},_constructUrl:function(){var t=[];t.push(this.get_baseUrl()),t.push("?"),this.userSuppliedParameters.length>0&&(t.push(this.userSuppliedParameters),t.push("&")),t.push(":embed=y"),t.push("&:showVizHome=n"),t.push("&:jsdebug=y"),this.fixedSize||t.push("&:bootstrapWhenNotified=y"),this.tabs||t.push("&:tabs=n"),this.toolbar?e.isNullOrUndefined(this.toolBarPosition)||(t.push("&:toolbar="),t.push(this.toolBarPosition)):t.push("&:toolbar=n");var i=this._createOptions;for(var n in i){var r={key:n,value:i[n]};"embed"!==r.key&&"height"!==r.key&&"width"!==r.key&&"autoSize"!==r.key&&"hideTabs"!==r.key&&"hideToolbar"!==r.key&&"onFirstInteractive"!==r.key&&"onFirstVizSizeKnown"!==r.key&&"toolbarPosition"!==r.key&&"instanceIdToClone"!==r.key&&(t.push("&"),t.push(encodeURIComponent(r.key)),t.push("="),t.push(encodeURIComponent(r.value.toString())))}return t.push("&:apiID="+this.handlerId),e.isValue(this._createOptions.instanceIdToClone)&&t.push("#"+this._createOptions.instanceIdToClone),t.join("")}},r._WorkbookImpl=function(e,t,i){this._publishedSheetsInfo=new r._Collection,this._customViews=new r._Collection,this._updatedCustomViews=new r._Collection,this._removedCustomViews=new r._Collection,this._vizImpl=e,this._messagingOptions=t,this._getClientInfo(i)},r._WorkbookImpl._createDashboardZones=function(e){e=e||[];for(var t=[],i=0;i<e.length;i++){var n=e[i],a=n.zoneType,o=r.$create_Size(n.width,n.height),s=r.$create_Point(n.x,n.y),l=n.name,u=r.$create__dashboardZoneInfo(l,a,s,o,n.zoneId);t.push(u)}return t},r._WorkbookImpl._extractSheetName=function(t){if(e.isNullOrUndefined(t))return null;if(r._Utility.isString(t))return t;var i=t,n=e.Delegate.create(i,i.getName);return e.isValue(n)?n():null},r._WorkbookImpl._createSheetSize=function(t){return e.isNullOrUndefined(t)?r.SheetSizeFactory.createAutomatic():r.SheetSizeFactory.fromSizeConstraints(t.sizeConstraints)},r._WorkbookImpl._processParameters=function(t){for(var i=new r._Collection,n=e.IEnumerator.getEnumerator(t.parameters);n.moveNext();){var a=n.current,o=new r._parameterImpl(a);i._add(o.get__name(),o.get__parameter())}return i},r._WorkbookImpl._findAndCreateParameterImpl=function(t,i){for(var n=e.IEnumerator.getEnumerator(i.parameters);n.moveNext();){var a=n.current;if(a.name===t)return new r._parameterImpl(a)}return null},r._WorkbookImpl.prototype={_workbook:null,_vizImpl:null,_name:null,_activeSheetImpl:null,_activatingHiddenSheetImpl:null,_isDownloadAllowed:!1,_messagingOptions:null,get_workbook:function(){return e.isNullOrUndefined(this._workbook)&&(this._workbook=new i.Workbook(this)),this._workbook},get_viz:function(){return this._vizImpl.get__viz()},get_publishedSheets:function(){return this._publishedSheetsInfo},get_name:function(){return this._name},get_activeSheetImpl:function(){return this._activeSheetImpl},get_activeCustomView:function(){return this._currentCustomView},get_isDownloadAllowed:function(){return this._isDownloadAllowed},_findActiveSheetOrSheetWithinActiveDashboard:function(t){if(e.isNullOrUndefined(this._activeSheetImpl))return null;var i=r._WorkbookImpl._extractSheetName(t);if(e.isNullOrUndefined(i))return null;if(i===this._activeSheetImpl.get_name())return this._activeSheetImpl;if(this._activeSheetImpl.get_isDashboard()){var n=this._activeSheetImpl.get_worksheets()._get(i);if(e.isValue(n))return n._impl}return null},_setActiveSheetAsync:function(t){if(r._Utility.isNumber(t)){var i=t;if(i<this._publishedSheetsInfo.get__length()&&i>=0)return this._activateSheetWithInfoAsync(this._publishedSheetsInfo.get_item(i)._impl);throw r._TableauException.createIndexOutOfRange(i)}var n=r._WorkbookImpl._extractSheetName(t),a=this._publishedSheetsInfo._get(n);if(e.isValue(a))return this._activateSheetWithInfoAsync(a._impl);if(this._activeSheetImpl.get_isDashboard()){var o=this._activeSheetImpl.get_worksheets()._get(n);if(e.isValue(o)){this._activatingHiddenSheetImpl=null;var s="";return o.getIsHidden()?this._activatingHiddenSheetImpl=o._impl:s=o._impl.get_url(),this._activateSheetInternalAsync(o._impl.get_name(),s)}}throw r._TableauException.create("sheetNotInWorkbook","Sheet is not found in Workbook")},_revertAllAsync:function(){var e=new r._Deferred,t=new r._CommandReturnHandler("api.RevertAllCommand",1,(function(t){e.resolve()}),(function(t,i){e.reject(r._TableauException.createServerError(i))}));return this._sendCommand(null,t),e.get_promise()},_update:function(e){this._getClientInfo(e)},_activateSheetWithInfoAsync:function(e){return this._activateSheetInternalAsync(e.name,e.url)},_activateSheetInternalAsync:function(t,i){var n=new r._Deferred;if(e.isValue(this._activeSheetImpl)&&t===this._activeSheetImpl.get_name())return n.resolve(this._activeSheetImpl.get_sheet()),n.get_promise();var a={};a["api.switchToSheetName"]=t,a["api.switchToRepositoryUrl"]=i,a["api.oldRepositoryUrl"]=this._activeSheetImpl.get_url();var o=new r._CommandReturnHandler("api.SwitchActiveSheetCommand",0,e.Delegate.create(this,(function(t){this._vizImpl._workbookTabSwitchHandler=e.Delegate.create(this,(function(){this._vizImpl._workbookTabSwitchHandler=null,n.resolve(this._activeSheetImpl.get_sheet())}))})),(function(e,t){n.reject(r._TableauException.createServerError(t))}));return this._sendCommand(a,o),n.get_promise()},_updateActiveSheetAsync:function(){var t=new r._Deferred,i={};i["api.switchToSheetName"]=this._activeSheetImpl.get_name(),i["api.switchToRepositoryUrl"]=this._activeSheetImpl.get_url(),i["api.oldRepositoryUrl"]=this._activeSheetImpl.get_url();var n=new r._CommandReturnHandler("api.UpdateActiveSheetCommand",0,e.Delegate.create(this,(function(e){t.resolve(this._activeSheetImpl.get_sheet())})),(function(e,i){t.reject(r._TableauException.createServerError(i))}));return this._sendCommand(i,n),t.get_promise()},_sendCommand:function(e,t){this._messagingOptions.sendCommand(e,t)},_getClientInfo:function(t){var i=new r._CommandReturnHandler("api.GetClientInfoCommand",0,e.Delegate.create(this,(function(i){var n=i;this._processInfo(n),e.isValue(t)&&t()})),null);this._sendCommand(null,i)},_processInfo:function(e){this._name=e.workbookName,this._isDownloadAllowed=e.isDownloadAllowed,this._vizImpl._setAreAutomaticUpdatesPaused(!e.isAutoUpdate),this._createSheetsInfo(e),this._initializeActiveSheet(e)},_initializeActiveSheet:function(t){var i=t.currentSheetName,n=this._publishedSheetsInfo._get(i);if(e.isNullOrUndefined(n)&&e.isNullOrUndefined(this._activatingHiddenSheetImpl))throw r._TableauException.createInternalError("The active sheet was not specified in baseSheets");if(!e.isValue(this._activeSheetImpl)||this._activeSheetImpl.get_name()!==i){if(e.isValue(this._activeSheetImpl)){this._activeSheetImpl.set_isActive(!1);var a=this._publishedSheetsInfo._get(this._activeSheetImpl.get_name());if(e.isValue(a)&&(a._impl.isActive=!1),"story"===this._activeSheetImpl.get_sheetType())(h=this._activeSheetImpl).remove_activeStoryPointChange(e.Delegate.create(this._vizImpl,this._vizImpl.raiseStoryPointSwitch))}if(e.isValue(this._activatingHiddenSheetImpl)){var o=r.$create__SheetInfoImpl(this._activatingHiddenSheetImpl.get_name(),"worksheet",-1,this._activatingHiddenSheetImpl.get_size(),this.get_workbook(),"",!0,!0,4294967295);this._activatingHiddenSheetImpl=null,this._activeSheetImpl=new r._WorksheetImpl(o,this,this._messagingOptions,null)}else{for(var s=null,l=0,u=t.publishedSheets.length;l<u;l++)if(t.publishedSheets[l].name===i){s=t.publishedSheets[l];break}if(e.isNullOrUndefined(s))throw r._TableauException.createInternalError("No base sheet was found corresponding to the active sheet.");var _=e.Delegate.create(this,(function(e){return this._publishedSheetsInfo._get(e)}));if("dashboard"===s.sheetType){var c=new r._DashboardImpl(n._impl,this,this._messagingOptions);this._activeSheetImpl=c;var m=r._WorkbookImpl._createDashboardZones(t.dashboardZones);c._addObjects(m,_)}else if("story"===s.sheetType){var h=new r._StoryImpl(n._impl,this,this._messagingOptions,t.story,_);this._activeSheetImpl=h,h.add_activeStoryPointChange(e.Delegate.create(this._vizImpl,this._vizImpl.raiseStoryPointSwitch))}else this._activeSheetImpl=new r._WorksheetImpl(n._impl,this,this._messagingOptions,null);n._impl.isActive=!0}this._activeSheetImpl.set_isActive(!0)}},_createSheetsInfo:function(t){var n=t.publishedSheets;if(!e.isNullOrUndefined(n))for(var a=0;a<n.length;a++){var o=n[a],s=o.name,l=this._publishedSheetsInfo._get(s),u=r._WorkbookImpl._createSheetSize(o);if(e.isNullOrUndefined(l)){var _=s===t.currentSheetName,c=o.sheetType,m=r.$create__SheetInfoImpl(s,c,a,u,this.get_workbook(),o.repositoryUrl,_,!1,4294967295);l=new i.SheetInfo(m),this._publishedSheetsInfo._add(s,l)}else l._impl.size=u}},_currentCustomView:null,get__customViews:function(){return this._customViews},set__customViews:function(e){return this._customViews=e,e},get__updatedCustomViews:function(){return this._updatedCustomViews},set__updatedCustomViews:function(e){return this._updatedCustomViews=e,e},get__removedCustomViews:function(){return this._removedCustomViews},set__removedCustomViews:function(e){return this._removedCustomViews=e,e},get__currentCustomView:function(){return this._currentCustomView},set__currentCustomView:function(e){return this._currentCustomView=e,e},_getCustomViewsAsync:function(){return r._CustomViewImpl._getCustomViewsAsync(this,this._messagingOptions)},_showCustomViewAsync:function(t){if(e.isNullOrUndefined(t)||r._Utility.isNullOrEmpty(t))return r._CustomViewImpl._showCustomViewAsync(this,this._messagingOptions,null);var i=this._customViews._get(t);if(e.isNullOrUndefined(i)){var n=new r._Deferred;return n.reject(r._TableauException.createInvalidCustomViewName(t)),n.get_promise()}return i._impl._showAsync()},_removeCustomViewAsync:function(t){if(r._Utility.isNullOrEmpty(t))throw r._TableauException.createNullOrEmptyParameter("customViewName");var i=this._customViews._get(t);if(e.isNullOrUndefined(i)){var n=new r._Deferred;return n.reject(r._TableauException.createInvalidCustomViewName(t)),n.get_promise()}return i._impl._removeAsync()},_rememberCustomViewAsync:function(e){if(r._Utility.isNullOrEmpty(e))throw r._TableauException.createInvalidParameter("customViewName");return r._CustomViewImpl._saveNewAsync(this,this._messagingOptions,e)},_setActiveCustomViewAsDefaultAsync:function(){return r._CustomViewImpl._makeCurrentCustomViewDefaultAsync(this,this._messagingOptions)},_parameters:null,_lastChangedParameterImpl:null,get__lastChangedParameterImpl:function(){return this._lastChangedParameterImpl},set__lastChangedParameterImpl:function(e){return this._lastChangedParameterImpl=e,e},get__parameters:function(){return this._parameters},_getSingleParameterAsync:function(t){var i=new r._Deferred;if(e.isValue(this._lastChangedParameterImpl))return i.resolve(this._lastChangedParameterImpl.get__parameter()),i.get_promise();var n=new r._CommandReturnHandler("api.FetchParametersCommand",0,e.Delegate.create(this,(function(e){var n=e,a=r._WorkbookImpl._findAndCreateParameterImpl(t,n);this._lastChangedParameterImpl=a,i.resolve(a.get__parameter())})),(function(e,t){i.reject(r._TableauException.createServerError(t))}));return this._sendCommand({},n),i.get_promise()},_getParametersAsync:function(){var t=new r._Deferred,i=new r._CommandReturnHandler("api.FetchParametersCommand",0,e.Delegate.create(this,(function(e){var i=e;this._parameters=r._WorkbookImpl._processParameters(i),t.resolve(this.get__parameters()._toApiCollection())})),(function(e,i){t.reject(r._TableauException.createServerError(i))}));return this._sendCommand({},i),t.get_promise()},_changeParameterValueAsync:function(t,i){var n=new r._Deferred,a=null;if(e.isValue(this._parameters)){if(e.isNullOrUndefined(this._parameters._get(t)))return n.reject(r._TableauException.createInvalidParameter(t)),n.get_promise();if(a=this._parameters._get(t)._impl,e.isNullOrUndefined(a))return n.reject(r._TableauException.createInvalidParameter(t)),n.get_promise()}var o={};if(o["api.setParameterName"]=e.isValue(this._parameters)?a.get__name():t,e.isValue(i)&&r._Utility.isDate(i)){var s=i,l=r._Utility.serializeDateForServer(s);o["api.setParameterValue"]=l}else o["api.setParameterValue"]=e.isValue(i)?i.toString():null;this._lastChangedParameterImpl=null;var u=new r._CommandReturnHandler("api.SetParameterValueCommand",0,e.Delegate.create(this,(function(i){var a=i;if(e.isNullOrUndefined(a))n.reject(r._TableauException.create("serverError","server error"));else if(a.isValidPresModel){var o=new r._parameterImpl(a);this._lastChangedParameterImpl=o,n.resolve(o.get__parameter())}else n.reject(r._TableauException.createInvalidParameter(t))})),(function(e,i){n.reject(r._TableauException.createInvalidParameter(t))}));return this._sendCommand(o,u),n.get_promise()}},r._WorksheetImpl=function(e,t,i,n){this._filters$1=new r._Collection,this._selectedMarks$1=new r._Collection,r._WorksheetImpl.initializeBase(this,[e,t,i]),this._parentDashboardImpl$1=n},r._WorksheetImpl._filterCommandError=function(t){var i=t;if(e.isValue(i)&&e.isValue(i.errorCode)){var n=i.additionalInformation;switch(i.errorCode){case"invalidFilterFieldName":case"invalidFilterFieldValue":return r._TableauException.create(i.errorCode,n);case"invalidAggregationFieldName":return r._TableauException._createInvalidAggregationFieldName(n);default:return r._TableauException.createServerError(n)}}return null},r._WorksheetImpl._normalizeRangeFilterOption$1=function(t){if(e.isNullOrUndefined(t))throw r._TableauException.createNullOrEmptyParameter("filterOptions");if(e.isNullOrUndefined(t.min)&&e.isNullOrUndefined(t.max))throw r._TableauException.create("invalidParameter","At least one of filterOptions.min or filterOptions.max must be specified.");var i={};return e.isValue(t.min)&&(i.min=t.min),e.isValue(t.max)&&(i.max=t.max),e.isValue(t.nullOption)&&(i.nullOption=r._enums._normalizeNullOption(t.nullOption,"filterOptions.nullOption")),i},r._WorksheetImpl._normalizeRelativeDateFilterOptions$1=function(t){if(e.isNullOrUndefined(t))throw r._TableauException.createNullOrEmptyParameter("filterOptions");var i={};if(i.rangeType=r._enums._normalizeDateRangeType(t.rangeType,"filterOptions.rangeType"),i.periodType=r._enums._normalizePeriodType(t.periodType,"filterOptions.periodType"),"lastn"===i.rangeType||"nextn"===i.rangeType){if(e.isNullOrUndefined(t.rangeN))throw r._TableauException.create("missingRangeNForRelativeDateFilters","Missing rangeN field for a relative date filter of LASTN or NEXTN.");i.rangeN=r._Utility.toInt(t.rangeN)}if(e.isValue(t.anchorDate)){if(!r._Utility.isDate(t.anchorDate)||!r._Utility.isDateValid(t.anchorDate))throw r._TableauException.createInvalidDateParameter("filterOptions.anchorDate");i.anchorDate=t.anchorDate}return i},r._WorksheetImpl._createFilterCommandReturnHandler$1=function(e,t,i){return new r._CommandReturnHandler(e,1,(function(e){var n=r._WorksheetImpl._filterCommandError(e);null==n?i.resolve(t):i.reject(n)}),(function(e,n){if(e)i.reject(r._TableauException.createInvalidFilterFieldNameOrValue(t));else{var a=r._TableauException.create("filterCannotBePerformed",n);i.reject(a)}}))},r._WorksheetImpl._createSelectionCommandError$1=function(t){var i=t;if(e.isValue(i)&&e.isValue(i.errorCode)){var n=i.additionalInformation;switch(i.errorCode){case"invalidSelectionFieldName":case"invalidSelectionValue":case"invalidSelectionDate":return r._TableauException.create(i.errorCode,n)}}return null},r._WorksheetImpl.prototype={_worksheet$1:null,_parentDashboardImpl$1:null,get_sheet:function(){return this.get_worksheet()},get_worksheet:function(){return null==this._worksheet$1&&(this._worksheet$1=new i.Worksheet(this)),this._worksheet$1},get_parentDashboardImpl:function(){return this._parentDashboardImpl$1},get_parentDashboard:function(){return e.isValue(this._parentDashboardImpl$1)?this._parentDashboardImpl$1.get_dashboard():null},_getDataSourcesAsync:function(){this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();var e=new r._Deferred,t={};t["api.worksheetName"]=this.get_name();var i=new r._CommandReturnHandler("api.GetDataSourcesCommand",0,(function(t){var i=t,n=r._DataSourceImpl.processDataSourcesForWorksheet(i);e.resolve(n._toApiCollection())}),(function(t,i){e.reject(r._TableauException.createServerError(i))}));return this.sendCommand(t,i),e.get_promise()},_getDataSourceAsync:function(t){this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();var i=new r._Deferred,n={};n["api.dataSourceName"]=t,n["api.worksheetName"]=this.get_name();var a=new r._CommandReturnHandler("api.GetDataSourceCommand",0,(function(n){var a=n,o=r._DataSourceImpl.processDataSource(a);e.isValue(o)?i.resolve(o.get_dataSource()):i.reject(r._TableauException.createServerError("Data source '"+t+"' not found"))}),(function(e,t){i.reject(r._TableauException.createServerError(t))}));return this.sendCommand(n,a),i.get_promise()},_verifyActiveSheetOrEmbeddedInActiveDashboard$1:function(){var t=this.get_isActive(),i=e.isValue(this._parentDashboardImpl$1)&&this._parentDashboardImpl$1.get_isActive(),n=e.isValue(this.get_parentStoryPointImpl())&&this.get_parentStoryPointImpl().get_parentStoryImpl().get_isActive();if(!t&&!i&&!n)throw r._TableauException.createNotActiveSheet()},_addVisualIdToCommand$1:function(t){if(e.isValue(this.get_parentStoryPointImpl())){var i={};i.worksheet=this.get_name(),e.isValue(this.get_parentDashboardImpl())&&(i.dashboard=this.get_parentDashboardImpl().get_name()),i.flipboardZoneId=this.get_parentStoryPointImpl().get_containedSheetImpl().get_zoneId(),i.storyboard=this.get_parentStoryPointImpl().get_parentStoryImpl().get_name(),i.storyPointId=this.get_parentStoryPointImpl().get_storyPointId(),t["api.visualId"]=i}else t["api.worksheetName"]=this.get_name(),e.isValue(this.get_parentDashboardImpl())&&(t["api.dashboardName"]=this.get_parentDashboardImpl().get_name())},get__filters:function(){return this._filters$1},set__filters:function(e){return this._filters$1=e,e},_getFilterAsync:function(t,n,a){if(!r._Utility.isNullOrEmpty(t)&&!r._Utility.isNullOrEmpty(n))throw r._TableauException.createInternalError("Only fieldName OR fieldCaption is allowed, not both.");a=a||{};var o=new r._Deferred,s={};this._addVisualIdToCommand$1(s),!r._Utility.isNullOrEmpty(n)&&r._Utility.isNullOrEmpty(t)&&(s["api.fieldCaption"]=n),r._Utility.isNullOrEmpty(t)||(s["api.fieldName"]=t),s["api.filterHierarchicalLevels"]=0,s["api.ignoreDomain"]=a.ignoreDomain||!1;var l=new r._CommandReturnHandler("api.GetOneFilterInfoCommand",0,e.Delegate.create(this,(function(e){var t=r._WorksheetImpl._filterCommandError(e);if(null==t){var n=e,a=i.Filter._createFilter(this,n);o.resolve(a)}else o.reject(t)})),(function(e,t){o.reject(r._TableauException.createServerError(t))}));return this.sendCommand(s,l),o.get_promise()},_getFiltersAsync:function(t){this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),t=t||{};var n=new r._Deferred,a={};this._addVisualIdToCommand$1(a),a["api.ignoreDomain"]=t.ignoreDomain||!1;var o=new r._CommandReturnHandler("api.GetFiltersListCommand",0,e.Delegate.create(this,(function(e){var t=e;this.set__filters(i.Filter._processFiltersList(this,t)),n.resolve(this.get__filters()._toApiCollection())})),(function(e,t){n.reject(r._TableauException.createServerError(t))}));return this.sendCommand(a,o),n.get_promise()},_applyFilterAsync:function(e,t,i,n){return this._applyFilterWithValuesInternalAsync$1(e,t,i,n)},_clearFilterAsync:function(e){return this._clearFilterInternalAsync$1(e)},_applyRangeFilterAsync:function(e,t){var i=r._WorksheetImpl._normalizeRangeFilterOption$1(t);return this._applyRangeFilterInternalAsync$1(e,i)},_applyRelativeDateFilterAsync:function(e,t){var i=r._WorksheetImpl._normalizeRelativeDateFilterOptions$1(t);return this._applyRelativeDateFilterInternalAsync$1(e,i)},_applyHierarchicalFilterAsync:function(t,i,n,a){if(e.isNullOrUndefined(i)&&"all"!==n)throw r._TableauException.createInvalidParameter("values");return this._applyHierarchicalFilterInternalAsync$1(t,i,n,a)},_clearFilterInternalAsync$1:function(e){if(this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),r._Utility.isNullOrEmpty(e))throw r._TableauException.createNullOrEmptyParameter("fieldName");var t=new r._Deferred,i={};i["api.fieldCaption"]=e,this._addVisualIdToCommand$1(i);var n=r._WorksheetImpl._createFilterCommandReturnHandler$1("api.ClearFilterCommand",e,t);return this.sendCommand(i,n),t.get_promise()},_applyFilterWithValuesInternalAsync$1:function(t,i,n,a){if(this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),r._Utility.isNullOrEmpty(t))throw r._TableauException.createNullOrEmptyParameter("fieldName");n=r._enums._normalizeFilterUpdateType(n,"updateType");var o=[];if(r._jQueryShim.isArray(i))for(var s=0;s<i.length;s++)o.push(i[s].toString());else e.isValue(i)&&o.push(i.toString());var l=new r._Deferred,u={};u["api.fieldCaption"]=t,u["api.filterUpdateType"]=n,u["api.exclude"]=!(!e.isValue(a)||!a.isExcludeMode),"all"!==n&&(u["api.filterCategoricalValues"]=o),this._addVisualIdToCommand$1(u);var _=r._WorksheetImpl._createFilterCommandReturnHandler$1("api.ApplyCategoricalFilterCommand",t,l);return this.sendCommand(u,_),l.get_promise()},_applyRangeFilterInternalAsync$1:function(t,i){if(this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),r._Utility.isNullOrEmpty(t))throw r._TableauException.createNullOrEmptyParameter("fieldName");if(e.isNullOrUndefined(i))throw r._TableauException.createNullOrEmptyParameter("filterOptions");var n={};if(n["api.fieldCaption"]=t,e.isValue(i.min))if(r._Utility.isDate(i.min)){var a=i.min;if(!r._Utility.isDateValid(a))throw r._TableauException.createInvalidDateParameter("filterOptions.min");n["api.filterRangeMin"]=r._Utility.serializeDateForServer(a)}else n["api.filterRangeMin"]=i.min;if(e.isValue(i.max))if(r._Utility.isDate(i.max)){a=i.max;if(!r._Utility.isDateValid(a))throw r._TableauException.createInvalidDateParameter("filterOptions.max");n["api.filterRangeMax"]=r._Utility.serializeDateForServer(a)}else n["api.filterRangeMax"]=i.max;e.isValue(i.nullOption)&&(n["api.filterRangeNullOption"]=i.nullOption),this._addVisualIdToCommand$1(n);var o=new r._Deferred,s=r._WorksheetImpl._createFilterCommandReturnHandler$1("api.ApplyRangeFilterCommand",t,o);return this.sendCommand(n,s),o.get_promise()},_applyRelativeDateFilterInternalAsync$1:function(t,i){if(this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),r._Utility.isNullOrEmpty(t))throw r._TableauException.createInvalidParameter("fieldName");if(e.isNullOrUndefined(i))throw r._TableauException.createInvalidParameter("filterOptions");var n={};if(n["api.fieldCaption"]=t,e.isValue(i)){if(n["api.filterPeriodType"]=i.periodType,n["api.filterDateRangeType"]=i.rangeType,"lastn"===i.rangeType||"nextn"===i.rangeType){if(e.isNullOrUndefined(i.rangeN))throw r._TableauException.create("missingRangeNForRelativeDateFilters","Missing rangeN field for a relative date filter of LASTN or NEXTN.");n["api.filterDateRange"]=i.rangeN}e.isValue(i.anchorDate)&&(n["api.filterDateArchorValue"]=r._Utility.serializeDateForServer(i.anchorDate))}this._addVisualIdToCommand$1(n);var a=new r._Deferred,o=r._WorksheetImpl._createFilterCommandReturnHandler$1("api.ApplyRelativeDateFilterCommand",t,a);return this.sendCommand(n,o),a.get_promise()},_applyHierarchicalFilterInternalAsync$1:function(t,i,n,a){if(this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),r._Utility.isNullOrEmpty(t))throw r._TableauException.createNullOrEmptyParameter("fieldName");n=r._enums._normalizeFilterUpdateType(n,"updateType");var o=null,s=null;if(r._jQueryShim.isArray(i)){o=[];for(var l=i,u=0;u<l.length;u++)o.push(l[u].toString())}else if(r._Utility.isString(i))(o=[]).push(i.toString());else if(e.isValue(i)&&e.isValue(i.levels)){var _=i.levels;if(s=[],r._jQueryShim.isArray(_)){var c=_;for(u=0;u<c.length;u++)s.push(c[u].toString())}else s.push(_.toString())}else if(e.isValue(i))throw r._TableauException.createInvalidParameter("values");var m={};m["api.fieldCaption"]=t,m["api.filterUpdateType"]=n,m["api.exclude"]=!(!e.isValue(a)||!a.isExcludeMode),null!=o&&(m["api.filterHierarchicalValues"]=r.JsonUtil.toJson(o,!1,"")),null!=s&&(m["api.filterHierarchicalLevels"]=r.JsonUtil.toJson(s,!1,"")),this._addVisualIdToCommand$1(m);var h=new r._Deferred,d=r._WorksheetImpl._createFilterCommandReturnHandler$1("api.ApplyHierarchicalFilterCommand",t,h);return this.sendCommand(m,d),h.get_promise()},get_selectedMarks:function(){return this._selectedMarks$1},set_selectedMarks:function(e){return this._selectedMarks$1=e,e},_clearSelectedMarksAsync:function(){this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();var e=new r._Deferred,t={};this._addVisualIdToCommand$1(t),t["api.filterUpdateType"]="replace";var i=new r._CommandReturnHandler("api.SelectMarksCommand",1,(function(t){e.resolve()}),(function(t,i){e.reject(r._TableauException.createServerError(i))}));return this.sendCommand(t,i),e.get_promise()},_selectMarksAsync:function(e,t,i){return this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),null==e&&null==t?this._clearSelectedMarksAsync():r._Utility.isString(e)&&(r._jQueryShim.isArray(t)||r._Utility.isString(t)||!r._enums._isSelectionUpdateType(t))?this._selectMarksWithFieldNameAndValueAsync$1(e,t,i):r._jQueryShim.isArray(e)?this._selectMarksWithMarksArrayAsync$1(e,t):this._selectMarksWithMultiDimOptionAsync$1(e,t)},_getSelectedMarksAsync:function(){this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();var t=new r._Deferred,i={};this._addVisualIdToCommand$1(i);var n=new r._CommandReturnHandler("api.FetchSelectedMarksCommand",0,e.Delegate.create(this,(function(e){var i=e;this._selectedMarks$1=r._markImpl._processSelectedMarks(i),t.resolve(this._selectedMarks$1._toApiCollection())})),(function(e,i){t.reject(r._TableauException.createServerError(i))}));return this.sendCommand(i,n),t.get_promise()},_selectMarksWithFieldNameAndValueAsync$1:function(e,t,i){var n=[],r=[],a=[],o=[],s=[],l=[];return this._parseMarksParam$1(n,r,a,o,s,l,e,t),this._selectMarksWithValuesAsync$1(null,n,r,a,o,s,l,i)},_selectMarksWithMultiDimOptionAsync$1:function(e,t){var i=e,n=[],a=[],o=[],s=[],l=[],u=[],_=i;for(var c in _){var m={key:c,value:_[c]};e.hasOwnProperty(m.key)&&(r._jQueryShim.isFunction(i[m.key])||this._parseMarksParam$1(n,a,o,s,l,u,m.key,m.value))}return this._selectMarksWithValuesAsync$1(null,n,a,o,s,l,u,t)},_selectMarksWithMarksArrayAsync$1:function(t,i){for(var n=[],a=[],o=[],s=[],l=[],u=[],_=[],c=0;c<t.length;c++){var m=t[c];if(e.isValue(m._impl.get__tupleId())&&m._impl.get__tupleId()>0)_.push(m._impl.get__tupleId());else for(var h=m._impl.get__pairs(),d=0;d<h.get__length();d++){var p=h.get_item(d);p.hasOwnProperty("fieldName")&&p.hasOwnProperty("value")&&!r._jQueryShim.isFunction(p.fieldName)&&!r._jQueryShim.isFunction(p.value)&&this._parseMarksParam$1(n,a,o,s,l,u,p.fieldName,p.value)}}return this._selectMarksWithValuesAsync$1(_,n,a,o,s,l,u,i)},_parseMarksParam$1:function(t,i,n,a,o,s,l,u){var _=u;if(r._WorksheetImpl._regexHierarchicalFieldName$1.test(l))this._addToParamLists$1(n,a,l,u);else if(e.isValue(_.min)||e.isValue(_.max)){var c={};if(e.isValue(_.min))if(r._Utility.isDate(_.min)){var m=_.min;if(!r._Utility.isDateValid(m))throw r._TableauException.createInvalidDateParameter("options.min");c.min=r._Utility.serializeDateForServer(m)}else c.min=_.min;if(e.isValue(_.max))if(r._Utility.isDate(_.max)){m=_.max;if(!r._Utility.isDateValid(m))throw r._TableauException.createInvalidDateParameter("options.max");c.max=r._Utility.serializeDateForServer(m)}else c.max=_.max;if(e.isValue(_.nullOption)){var h=r._enums._normalizeNullOption(_.nullOption,"options.nullOption");c.nullOption=h}else c.nullOption="allValues";var d=r.JsonUtil.toJson(c,!1,"");this._addToParamLists$1(o,s,l,d)}else this._addToParamLists$1(t,i,l,u)},_addToParamLists$1:function(e,t,i,n){var a=[];if(r._jQueryShim.isArray(n))for(var o=n,s=0;s<o.length;s++)a.push(o[s]);else a.push(n);t.push(a),e.push(i)},_selectMarksWithValuesAsync$1:function(e,t,i,n,a,o,s,l){var u={};if(this._addVisualIdToCommand$1(u),l=r._enums._normalizeSelectionUpdateType(l,"updateType"),u["api.filterUpdateType"]=l,r._Utility.isNullOrEmpty(e)||(u["api.tupleIds"]=r.JsonUtil.toJson(e,!1,"")),!r._Utility.isNullOrEmpty(t)&&!r._Utility.isNullOrEmpty(i)){u["api.categoricalFieldCaption"]=r.JsonUtil.toJson(t,!1,"");for(var _=[],c=0;c<i.length;c++){var m=r.JsonUtil.toJson(i[c],!1,"");_.push(m)}u["api.categoricalMarkValues"]=r.JsonUtil.toJson(_,!1,"")}if(!r._Utility.isNullOrEmpty(n)&&!r._Utility.isNullOrEmpty(a)){u["api.hierarchicalFieldCaption"]=r.JsonUtil.toJson(n,!1,"");for(_=[],c=0;c<a.length;c++){m=r.JsonUtil.toJson(a[c],!1,"");_.push(m)}u["api.hierarchicalMarkValues"]=r.JsonUtil.toJson(_,!1,"")}if(!r._Utility.isNullOrEmpty(o)&&!r._Utility.isNullOrEmpty(s)){u["api.rangeFieldCaption"]=r.JsonUtil.toJson(o,!1,"");for(_=[],c=0;c<s.length;c++){m=r.JsonUtil.toJson(s[c],!1,"");_.push(m)}u["api.rangeMarkValues"]=r.JsonUtil.toJson(_,!1,"")}if(r._Utility.isNullOrEmpty(u["api.tupleIds"])&&r._Utility.isNullOrEmpty(u["api.categoricalFieldCaption"])&&r._Utility.isNullOrEmpty(u["api.hierarchicalFieldCaption"])&&r._Utility.isNullOrEmpty(u["api.rangeFieldCaption"]))throw r._TableauException.createInvalidParameter("fieldNameOrFieldValuesMap");var h=new r._Deferred,d=new r._CommandReturnHandler("api.SelectMarksCommand",1,(function(e){var t=r._WorksheetImpl._createSelectionCommandError$1(e);null==t?h.resolve():h.reject(t)}),(function(e,t){h.reject(r._TableauException.createServerError(t))}));return this.sendCommand(u,d),h.get_promise()}},r.JsonUtil=function(){},r.JsonUtil.parseJson=function(e){return r._jQueryShim.parseJSON(e)},r.JsonUtil.toJson=function(e,t,i){t=t||!1,i=i||"";return r.JsonUtil._serialize(e,t,i,[])},r.JsonUtil._indexOf=function(t,i,n){if(e.isValue(Array.prototype.indexOf))return t.indexOf(i,n);n=n||0;var r=t.length;if(r>0)for(var a=n;a<r;a++)if(t[a]===i)return a;return-1},r.JsonUtil._contains=function(e,t,i){return r.JsonUtil._indexOf(e,t,i)>=0},r.JsonUtil._serialize=function(t,i,n,a){if(r.JsonUtil._contains(a,t))throw Error.createError("The object contains recursive reference of sub-objects",null);if(e.isUndefined(t))return"undefined";if(null==t)return"null";var o,s=r._jQueryShim.type(t);if("number"===s||"boolean"===s)return t.toString();if("string"===s)return r.JsonUtil._escapeString(t);a.push(t),n=n||"";var l=i?n+"\t":"",u=t.__json__||t.json;if(r._jQueryShim.isFunction(u)&&t!==(o=u(t))){var _=r.JsonUtil._serialize(o,i,l,a);return a.pop(),_}if(e.isValue(t.nodeType)&&e.isValue(t.cloneNode))throw Error.createError("Can't serialize DOM nodes",null);var c=i?" ":"",m=i?"\n":"";return r._jQueryShim.isArray(t)?r.JsonUtil._serializeArray(t,i,n,a,l,m):"function"===s?(a.pop(),null):r.JsonUtil._serializeGeneric(t,i,n,a,l,m,c)},r.JsonUtil._serializeGeneric=function(t,i,n,a,o,s,l){var u=t,_=new e.StringBuilder("{"),c=!1,m=u;for(var h in m){var d,p,f={key:h,value:m[h]};if("number"==typeof f.key)d='"'+f.key+'"';else{if("string"!=typeof f.key)continue;d=r.JsonUtil._escapeString(f.key)}null!=(p=r.JsonUtil._serialize(f.value,i,o,a))&&(c&&_.append(","),_.append(s+o+d+":"+l+p),c=!0)}return _.append(s+n+"}"),a.pop(),_.toString()},r.JsonUtil._serializeArray=function(t,i,n,a,o,s){for(var l=!1,u=new e.StringBuilder("["),_=t,c=0;c<_.length;c++){var m=_[c],h=r.JsonUtil._serialize(m,i,o,a);null==h&&(h="undefined"),l&&u.append(","),u.append(s+o+h),l=!0}return u.append(s+n+"]"),a.pop(),u.toString()},r.JsonUtil._escapeString=function(e){return e=(e=(e=(e=(e=(e='"'+e.replace(/(["\\])/g,"\\$1")+'"').replace(new RegExp("[\f]","g"),"\\f")).replace(new RegExp("[\b]","g"),"\\b")).replace(new RegExp("[\n]","g"),"\\n")).replace(new RegExp("[\t]","g"),"\\t")).replace(new RegExp("[\r]","g"),"\\r")},t.registerNamespace("tableauSoftware"),r.$create_DataValue=function(e,t,i){var n={};return n.value=e,r._Utility.isNullOrEmpty(i)?n.formattedValue=t:n.formattedValue=i,n},r.$create_VizSize=function(e,t){var i={};return i.sheetSize=e,i.chromeHeight=t,i},r.$create_Point=function(e,t){var i={};return i.x=e,i.y=t,i},r.$create_Size=function(e,t){var i={};return i.width=e,i.height=t,i},r.$create_SheetSize=function(t,i,n){var r={};return r.behavior=t||"automatic",e.isValue(i)&&(r.minSize=i),e.isValue(n)&&(r.maxSize=n),r},i.CustomView=function(e){this._impl=e},i.CustomView.prototype={_impl:null,getWorkbook:function(){return this._impl.get__workbook()},getUrl:function(){return this._impl.get__url()},getName:function(){return this._impl.get__name()},setName:function(e){this._impl.set__name(e)},getOwnerName:function(){return this._impl.get__ownerName()},getAdvertised:function(){return this._impl.get__advertised()},setAdvertised:function(e){this._impl.set__advertised(e)},getDefault:function(){return this._impl.get__isDefault()},saveAsync:function(){return this._impl.saveAsync()}},r.CustomViewEvent=function(e,t,i){r.CustomViewEvent.initializeBase(this,[e,t]),this._context$1=new r._customViewEventContext(t._impl.get__workbookImpl(),i)},r.CustomViewEvent.prototype={_context$1:null,getCustomViewAsync:function(){var t=new r._Deferred,i=null;return e.isValue(this._context$1.get__customViewImpl())&&(i=this._context$1.get__customViewImpl().get__customView()),t.resolve(i),t.get_promise()}},r._customViewEventContext=function(e,t){r._customViewEventContext.initializeBase(this,[e,null]),this._customViewImpl$1=t},r._customViewEventContext.prototype={_customViewImpl$1:null,get__customViewImpl:function(){return this._customViewImpl$1}},i.Dashboard=function(e){i.Dashboard.initializeBase(this,[e])},i.Dashboard.prototype={_impl:null,getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getObjects:function(){return this._impl.get_objects()._toApiCollection()},getWorksheets:function(){return this._impl.get_worksheets()._toApiCollection()}},i.DashboardObject=function(t,i,n){if("worksheet"===t._objectType&&e.isNullOrUndefined(n))throw r._TableauException.createInternalError("worksheet parameter is required for WORKSHEET objects");if("worksheet"!==t._objectType&&e.isValue(n))throw r._TableauException.createInternalError("worksheet parameter should be undefined for non-WORKSHEET objects");this._zoneInfo=t,this._dashboard=i,this._worksheet=n},i.DashboardObject.prototype={_zoneInfo:null,_dashboard:null,_worksheet:null,getObjectType:function(){return this._zoneInfo._objectType},getDashboard:function(){return this._dashboard},getWorksheet:function(){return this._worksheet},getPosition:function(){return this._zoneInfo._position},getSize:function(){return this._zoneInfo._size}},i.DataSource=function(e){this._impl=e},i.DataSource.prototype={_impl:null,getName:function(){return this._impl.get_name()},getFields:function(){return this._impl.get_fields()._toApiCollection()},getIsPrimary:function(){return this._impl.get_isPrimary()}},i.Field=function(e,t,i,n){this._dataSource=e,this._name=t,this._fieldRoleType=i,this._fieldAggrType=n},i.Field.prototype={_dataSource:null,_name:null,_fieldRoleType:null,_fieldAggrType:null,getDataSource:function(){return this._dataSource},getName:function(){return this._name},getRole:function(){return this._fieldRoleType},getAggregation:function(){return this._fieldAggrType}},i.CategoricalFilter=function(e,t){i.CategoricalFilter.initializeBase(this,[e,t]),this._initializeFromJson$1(t)},i.CategoricalFilter.prototype={_isExclude$1:!1,_appliedValues$1:null,getIsExcludeMode:function(){return this._isExclude$1},getAppliedValues:function(){return this._appliedValues$1},_updateFromJson:function(e){this._initializeFromJson$1(e)},_initializeFromJson$1:function(t){if(this._isExclude$1=t.isExclude,e.isValue(t.appliedValues)){this._appliedValues$1=[];for(var i=e.IEnumerator.getEnumerator(t.appliedValues);i.moveNext();){var n=i.current;this._appliedValues$1.push(r._Utility.getDataValue(n))}}}},i.Filter=function(e,t){this._worksheetImpl=e,this._initializeFromJson(t)},i.Filter._createFilter=function(e,t){switch(t.filterType){case"categorical":return new i.CategoricalFilter(e,t);case"relativedate":return new i.RelativeDateFilter(e,t);case"hierarchical":return new i.HierarchicalFilter(e,t);case"quantitative":return new i.QuantitativeFilter(e,t)}return null},i.Filter._processFiltersList=function(t,n){for(var a=new r._Collection,o=e.IEnumerator.getEnumerator(n.filters);o.moveNext();){var s=o.current,l=i.Filter._createFilter(t,s);a._add(s.caption,l)}return a},i.Filter.prototype={_worksheetImpl:null,_type:null,_caption:null,_field:null,_dataSourceName:null,_fieldRole:null,_fieldAggregation:null,getFilterType:function(){return this._type},getFieldName:function(){return this._caption},getWorksheet:function(){return this._worksheetImpl.get_worksheet()},getFieldAsync:function(){var t=new r._Deferred;if(null==this._field){var n=e.Delegate.create(this,(function(e){return this._field=new i.Field(e,this._caption,this._fieldRole,this._fieldAggregation),t.resolve(this._field),null}));this._worksheetImpl._getDataSourceAsync(this._dataSourceName).then(n,(function(e){return t.reject(e),null}))}else window.setTimeout(e.Delegate.create(this,(function(){t.resolve(this._field)})),0);return t.get_promise()},_update:function(e){this._initializeFromJson(e),this._updateFromJson(e)},_addFieldParams:function(e){},_initializeFromJson:function(e){this._caption=e.caption,this._type=e.filterType,this._field=null,this._dataSourceName=e.dataSourceName,this._fieldRole=e.fieldRole||0,this._fieldAggregation=e.fieldAggregation||0}},r.FilterEvent=function(e,t,i,n,a){r.FilterEvent.initializeBase(this,[e,t,i]),this._filterCaption$2=a,this._context$2=new r._filterEventContext(t._impl.get__workbookImpl(),i,n,a)},r.FilterEvent.prototype={_filterCaption$2:null,_context$2:null,getFieldName:function(){return this._filterCaption$2},getFilterAsync:function(){return this._context$2.get__worksheetImpl()._getFilterAsync(this._context$2.get__filterFieldName(),null,null)}},r._filterEventContext=function(e,t,i,n){r._filterEventContext.initializeBase(this,[e,t]),this._fieldFieldName$1=i,this._filterCaption$1=n},r._filterEventContext.prototype={_fieldFieldName$1:null,_filterCaption$1:null,get__filterFieldName:function(){return this._fieldFieldName$1},get__filterCaption:function(){return this._filterCaption$1}},i.HierarchicalFilter=function(e,t){i.HierarchicalFilter.initializeBase(this,[e,t]),this._initializeFromJson$1(t)},i.HierarchicalFilter.prototype={_levels$1:0,_addFieldParams:function(e){e["api.filterHierarchicalLevels"]=this._levels$1},_updateFromJson:function(e){this._initializeFromJson$1(e)},_initializeFromJson$1:function(e){this._levels$1=e.levels}},i.QuantitativeFilter=function(e,t){i.QuantitativeFilter.initializeBase(this,[e,t]),this._initializeFromJson$1(t)},i.QuantitativeFilter.prototype={_domainMin$1:null,_domainMax$1:null,_min$1:null,_max$1:null,_includeNullValues$1:!1,getMin:function(){return this._min$1},getMax:function(){return this._max$1},getIncludeNullValues:function(){return this._includeNullValues$1},getDomainMin:function(){return this._domainMin$1},getDomainMax:function(){return this._domainMax$1},_updateFromJson:function(e){this._initializeFromJson$1(e)},_initializeFromJson$1:function(e){this._domainMin$1=r._Utility.getDataValue(e.domainMinValue),this._domainMax$1=r._Utility.getDataValue(e.domainMaxValue),this._min$1=r._Utility.getDataValue(e.minValue),this._max$1=r._Utility.getDataValue(e.maxValue),this._includeNullValues$1=e.includeNullValues}},i.RelativeDateFilter=function(e,t){i.RelativeDateFilter.initializeBase(this,[e,t]),this._initializeFromJson$1(t)},i.RelativeDateFilter.prototype={_periodType$1:null,_rangeType$1:null,_rangeN$1:0,getPeriod:function(){return this._periodType$1},getRange:function(){return this._rangeType$1},getRangeN:function(){return this._rangeN$1},_updateFromJson:function(e){this._initializeFromJson$1(e)},_initializeFromJson$1:function(t){e.isValue(t.periodType)&&(this._periodType$1=r._enums._normalizePeriodType(t.periodType,"periodType")),e.isValue(t.rangeType)&&(this._rangeType$1=r._enums._normalizeDateRangeType(t.rangeType,"rangeType")),e.isValue(t.rangeN)&&(this._rangeN$1=t.rangeN)}},r.FirstVizSizeKnownEvent=function(e,t,i){r.FirstVizSizeKnownEvent.initializeBase(this,[e,t]),this._vizSize$1=i},r.FirstVizSizeKnownEvent.prototype={_vizSize$1:null,getVizSize:function(){return this._vizSize$1}},i.Version=function(e,t,i,n){this._major=e,this._minor=t,this._patch=i,this._metadata=n||null},i.Version.getCurrent=function(){return i.Version._currentVersion},i.Version.prototype={_major:0,_minor:0,_patch:0,_metadata:null,getMajor:function(){return this._major},getMinor:function(){return this._minor},getPatch:function(){return this._patch},getMetadata:function(){return this._metadata},toString:function(){var t=this._major+"."+this._minor+"."+this._patch;return e.isValue(this._metadata)&&this._metadata.length>0&&(t+="-"+this._metadata),t}},r.VizResizeEvent=function(e,t,i){r.VizResizeEvent.initializeBase(this,[e,t]),this._availableSize$1=i},r.VizResizeEvent.prototype={_availableSize$1:null,getAvailableSize:function(){return this._availableSize$1}},i.Mark=function(e){this._impl=new r._markImpl(e)},i.Mark.prototype={_impl:null,getPairs:function(){return this._impl.get__clonedPairs()}},r.MarksEvent=function(e,t,i){r.MarksEvent.initializeBase(this,[e,t,i]),this._context$2=new r._marksEventContext(t._impl.get__workbookImpl(),i)},r.MarksEvent.prototype={_context$2:null,getMarksAsync:function(){var t=this._context$2.get__worksheetImpl();return e.isValue(t.get_selectedMarks())?(new r._Deferred).resolve(t.get_selectedMarks()._toApiCollection()):t._getSelectedMarksAsync()}},r._marksEventContext=function(e,t){r._marksEventContext.initializeBase(this,[e,t])},i.Pair=function(t,i){this.fieldName=t,this.value=i,this.formattedValue=e.isValue(i)?i.toString():""},i.Pair.prototype={fieldName:null,value:null,formattedValue:null},i.Parameter=function(e){this._impl=e},i.Parameter.prototype={_impl:null,getName:function(){return this._impl.get__name()},getCurrentValue:function(){return this._impl.get__currentValue()},getDataType:function(){return this._impl.get__dataType()},getAllowableValuesType:function(){return this._impl.get__allowableValuesType()},getAllowableValues:function(){return this._impl.get__allowableValues()},getMinValue:function(){return this._impl.get__minValue()},getMaxValue:function(){return this._impl.get__maxValue()},getStepSize:function(){return this._impl.get__stepSize()},getDateStepPeriod:function(){return this._impl.get__dateStepPeriod()}},r.ParameterEvent=function(e,t,i){r.ParameterEvent.initializeBase(this,[e,t]),this._context$1=new r._parameterEventContext(t._impl.get__workbookImpl(),i)},r.ParameterEvent.prototype={_context$1:null,getParameterName:function(){return this._context$1.get__parameterName()},getParameterAsync:function(){return this._context$1.get__workbookImpl()._getSingleParameterAsync(this._context$1.get__parameterName())}},r._parameterEventContext=function(e,t){r._parameterEventContext.initializeBase(this,[e,null]),this._parameterName$1=t},r._parameterEventContext.prototype={_parameterName$1:null,get__parameterName:function(){return this._parameterName$1}},i.Sheet=function(e){r._Param.verifyValue(e,"sheetImpl"),this._impl=e},i.Sheet.prototype={_impl:null,getName:function(){return this._impl.get_name()},getIndex:function(){return this._impl.get_index()},getWorkbook:function(){return this._impl.get_workbookImpl().get_workbook()},getSize:function(){return this._impl.get_size()},getIsHidden:function(){return this._impl.get_isHidden()},getIsActive:function(){return this._impl.get_isActive()},getSheetType:function(){return this._impl.get_sheetType()},getUrl:function(){return this._impl.get_url()},changeSizeAsync:function(e){return this._impl.changeSizeAsync(e)}},i.SheetInfo=function(e){this._impl=e},i.SheetInfo.prototype={_impl:null,getName:function(){return this._impl.name},getSheetType:function(){return this._impl.sheetType},getSize:function(){return this._impl.size},getIndex:function(){return this._impl.index},getUrl:function(){return this._impl.url},getIsActive:function(){return this._impl.isActive},getIsHidden:function(){return this._impl.isHidden},getWorkbook:function(){return this._impl.workbook}},r.SheetSizeFactory=function(){},r.SheetSizeFactory.createAutomatic=function(){return r.$create_SheetSize("automatic",null,null)},r.SheetSizeFactory.fromSizeConstraints=function(e){var t=e.minHeight,i=e.minWidth,n=e.maxHeight,a=e.maxWidth,o="automatic",s=null,l=null;return t||i?n||a?n===t&&a===i?(o="exactly",s=r.$create_Size(i,t),l=r.$create_Size(i,t)):(o="range",s=r.$create_Size(i,t),l=r.$create_Size(a,n)):(o="atleast",s=r.$create_Size(i,t)):(n||a)&&(o="atmost",l=r.$create_Size(a,n)),r.$create_SheetSize(o,s,l)},i.Story=function(e){i.Story.initializeBase(this,[e])},i.Story.prototype={_impl:null,getActiveStoryPoint:function(){return this._impl.get_activeStoryPointImpl().get_storyPoint()},getStoryPointsInfo:function(){return this._impl.get_storyPointsInfo()},activatePreviousStoryPointAsync:function(){return this._impl.activatePreviousStoryPointAsync()},activateNextStoryPointAsync:function(){return this._impl.activateNextStoryPointAsync()},activateStoryPointAsync:function(e){return this._impl.activateStoryPointAsync(e)},revertStoryPointAsync:function(e){return this._impl.revertStoryPointAsync(e)}},i.StoryPoint=function(e){this._impl=e},i.StoryPoint.prototype={_impl:null,getCaption:function(){return this._impl.get_caption()},getContainedSheet:function(){return e.isValue(this._impl.get_containedSheetImpl())?this._impl.get_containedSheetImpl().get_sheet():null},getIndex:function(){return this._impl.get_index()},getIsActive:function(){return this._impl.get_isActive()},getIsUpdated:function(){return this._impl.get_isUpdated()},getParentStory:function(){return this._impl.get_parentStoryImpl().get_story()}},i.StoryPointInfo=function(e){this._impl=e},i.StoryPointInfo.prototype={_impl:null,getCaption:function(){return this._impl.caption},getIndex:function(){return this._impl.index},getIsActive:function(){return this._impl.isActive},getIsUpdated:function(){return this._impl.isUpdated},getParentStory:function(){return this._impl.parentStoryImpl.get_story()}},r.StoryPointSwitchEvent=function(e,t,i,n){r.StoryPointSwitchEvent.initializeBase(this,[e,t]),this._oldStoryPointInfo$1=i,this._newStoryPoint$1=n},r.StoryPointSwitchEvent.prototype={_oldStoryPointInfo$1:null,_newStoryPoint$1:null,getOldStoryPointInfo:function(){return this._oldStoryPointInfo$1},getNewStoryPoint:function(){return this._newStoryPoint$1}},r.TableauEvent=function(e,t){this._viz=t,this._eventName=e},r.TableauEvent.prototype={_viz:null,_eventName:null,getViz:function(){return this._viz},getEventName:function(){return this._eventName}},r.EventContext=function(e,t){this._workbookImpl=e,this._worksheetImpl=t},r.EventContext.prototype={_workbookImpl:null,_worksheetImpl:null,get__workbookImpl:function(){return this._workbookImpl},get__worksheetImpl:function(){return this._worksheetImpl}},r.TabSwitchEvent=function(e,t,i,n){r.TabSwitchEvent.initializeBase(this,[e,t]),this._oldName$1=i,this._newName$1=n},r.TabSwitchEvent.prototype={_oldName$1:null,_newName$1:null,getOldSheetName:function(){return this._oldName$1},getNewSheetName:function(){return this._newName$1}},i.Viz=function(e,t,i){var n=r._ApiObjectRegistry.getCrossDomainMessageRouter();this._impl=new r.VizImpl(n,this,e,t,i),this._impl._create()},i.Viz.getLastRequestMessage=function(){return r._ApiCommand.lastRequestMessage},i.Viz.getLastResponseMessage=function(){return r._ApiCommand.lastResponseMessage},i.Viz.getLastClientInfoResponseMessage=function(){return r._ApiCommand.lastClientInfoResponseMessage},i.Viz.prototype={_impl:null,getAreTabsHidden:function(){return this._impl.get__areTabsHidden()},getIsToolbarHidden:function(){return this._impl.get__isToolbarHidden()},getIsHidden:function(){return this._impl.get__isHidden()},getInstanceId:function(){return this._impl.get_instanceId()},getParentElement:function(){return this._impl.get__parentElement()},getUrl:function(){return this._impl.get__url()},getVizSize:function(){return this._impl.get__vizSize()},getWorkbook:function(){return this._impl.get__workbook()},getAreAutomaticUpdatesPaused:function(){return this._impl.get__areAutomaticUpdatesPaused()},getCurrentUrlAsync:function(){return this._impl.getCurrentUrlAsync()},addEventListener:function(e,t){this._impl.addEventListener(e,t)},removeEventListener:function(e,t){this._impl.removeEventListener(e,t)},dispose:function(){this._impl._dispose()},show:function(){this._impl._show()},hide:function(){this._impl._hide()},showExportDataDialog:function(e){this._impl._showExportDataDialog(e)},showExportCrossTabDialog:function(e){this._impl._showExportCrossTabDialog(e)},showExportImageDialog:function(){this._impl._showExportImageDialog()},showExportPDFDialog:function(){this._impl._showExportPDFDialog()},revertAllAsync:function(){return this._impl._revertAllAsync()},refreshDataAsync:function(){return this._impl._refreshDataAsync()},showShareDialog:function(){this._impl._showShareDialog()},showDownloadWorkbookDialog:function(){this._impl._showDownloadWorkbookDialog()},pauseAutomaticUpdatesAsync:function(){return this._impl._pauseAutomaticUpdatesAsync()},resumeAutomaticUpdatesAsync:function(){return this._impl._resumeAutomaticUpdatesAsync()},toggleAutomaticUpdatesAsync:function(){return this._impl._toggleAutomaticUpdatesAsync()},refreshSize:function(){this._impl._refreshSize()},setFrameSize:function(e,t){var i=e,n=t;r._Utility.isNumber(e)&&(i=e+"px"),r._Utility.isNumber(t)&&(n=t+"px"),this._impl._setFrameSizeAndUpdate(i,n)}},i.VizManager=function(){},i.VizManager.getVizs=function(){return r._VizManagerImpl.get__clonedVizs()},i.Workbook=function(e){this._workbookImpl=e},i.Workbook.prototype={_workbookImpl:null,getViz:function(){return this._workbookImpl.get_viz()},getPublishedSheetsInfo:function(){return this._workbookImpl.get_publishedSheets()._toApiCollection()},getName:function(){return this._workbookImpl.get_name()},getActiveSheet:function(){return this._workbookImpl.get_activeSheetImpl().get_sheet()},getActiveCustomView:function(){return this._workbookImpl.get_activeCustomView()},activateSheetAsync:function(e){return this._workbookImpl._setActiveSheetAsync(e)},revertAllAsync:function(){return this._workbookImpl._revertAllAsync()},getCustomViewsAsync:function(){return this._workbookImpl._getCustomViewsAsync()},showCustomViewAsync:function(e){return this._workbookImpl._showCustomViewAsync(e)},removeCustomViewAsync:function(e){return this._workbookImpl._removeCustomViewAsync(e)},rememberCustomViewAsync:function(e){return this._workbookImpl._rememberCustomViewAsync(e)},setActiveCustomViewAsDefaultAsync:function(){return this._workbookImpl._setActiveCustomViewAsDefaultAsync()},getParametersAsync:function(){return this._workbookImpl._getParametersAsync()},changeParameterValueAsync:function(e,t){return this._workbookImpl._changeParameterValueAsync(e,t)}},i.Worksheet=function(e){i.Worksheet.initializeBase(this,[e])},i.Worksheet.prototype={_impl:null,getParentDashboard:function(){return this._impl.get_parentDashboard()},getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getDataSourcesAsync:function(){return this._impl._getDataSourcesAsync()},getFilterAsync:function(e,t){return this._impl._getFilterAsync(null,e,t)},getFiltersAsync:function(e){return this._impl._getFiltersAsync(e)},applyFilterAsync:function(e,t,i,n){return this._impl._applyFilterAsync(e,t,i,n)},clearFilterAsync:function(e){return this._impl._clearFilterAsync(e)},applyRangeFilterAsync:function(e,t){return this._impl._applyRangeFilterAsync(e,t)},applyRelativeDateFilterAsync:function(e,t){return this._impl._applyRelativeDateFilterAsync(e,t)},applyHierarchicalFilterAsync:function(e,t,i,n){return this._impl._applyHierarchicalFilterAsync(e,t,i,n)},clearSelectedMarksAsync:function(){return this._impl._clearSelectedMarksAsync()},selectMarksAsync:function(e,t,i){return this._impl._selectMarksAsync(e,t,i)},getSelectedMarksAsync:function(){return this._impl._getSelectedMarksAsync()}},r.WorksheetEvent=function(e,t,i){r.WorksheetEvent.initializeBase(this,[e,t]),this._worksheetImpl$1=i},r.WorksheetEvent.prototype={_worksheetImpl$1:null,getWorksheet:function(){return this._worksheetImpl$1.get_worksheet()}},r._jQueryShim=function(){},r._jQueryShim.isFunction=function(e){return"function"===r._jQueryShim.type(e)},r._jQueryShim.isArray=function(t){return e.isValue(Array.isArray)?Array.isArray(t):"array"===r._jQueryShim.type(t)},r._jQueryShim.type=function(e){return null==e?String(e):r._jQueryShim._class2type[r._jQueryShim._toString.call(e)]||"object"},r._jQueryShim.trim=function(t){return e.isValue(r._jQueryShim._trim)?null==t?"":r._jQueryShim._trim.call(t):null==t?"":t.replace(r._jQueryShim._trimLeft,"").replace(r._jQueryShim._trimRight,"")},r._jQueryShim.parseJSON=function(t){if("string"!=typeof t||e.isNullOrUndefined(t))return null;if(t=r._jQueryShim.trim(t),window.JSON&&window.JSON.parse)return window.JSON.parse(t);if(r._jQueryShim._rvalidchars.test(t.replace(r._jQueryShim._rvalidescape,"@").replace(r._jQueryShim._rvalidtokens,"]").replace(r._jQueryShim._rvalidbraces,"")))return new Function("return "+t)();throw new Error("Invalid JSON: "+t)},r._ApiCommand.registerClass("tab._ApiCommand"),r._ApiServerResultParser.registerClass("tab._ApiServerResultParser"),r._ApiServerNotification.registerClass("tab._ApiServerNotification"),r._CommandReturnHandler.registerClass("tab._CommandReturnHandler"),r._crossDomainMessageRouter.registerClass("tab._crossDomainMessageRouter",null,r.ICrossDomainMessageRouter),r._doNothingCrossDomainHandler.registerClass("tab._doNothingCrossDomainHandler",null,r.ICrossDomainMessageHandler),r.CrossDomainMessagingOptions.registerClass("tab.CrossDomainMessagingOptions"),r._enums.registerClass("tab._enums"),r._ApiBootstrap.registerClass("tab._ApiBootstrap"),r._ApiObjectRegistry.registerClass("tab._ApiObjectRegistry"),r._CustomViewImpl.registerClass("tab._CustomViewImpl"),r._SheetImpl.registerClass("tab._SheetImpl"),r._DashboardImpl.registerClass("tab._DashboardImpl",r._SheetImpl),r._DataSourceImpl.registerClass("tab._DataSourceImpl"),r._deferredUtil.registerClass("tab._deferredUtil"),r._CollectionImpl.registerClass("tab._CollectionImpl"),r._DeferredImpl.registerClass("tab._DeferredImpl"),r._PromiseImpl.registerClass("tab._PromiseImpl"),r._markImpl.registerClass("tab._markImpl"),r._Param.registerClass("tab._Param"),r._parameterImpl.registerClass("tab._parameterImpl"),r._StoryImpl.registerClass("tab._StoryImpl",r._SheetImpl),r._StoryPointImpl.registerClass("tab._StoryPointImpl"),r.StoryPointInfoImplUtil.registerClass("tab.StoryPointInfoImplUtil"),r._TableauException.registerClass("tab._TableauException"),r._Utility.registerClass("tab._Utility"),r.VizImpl.registerClass("tab.VizImpl",null,r.ICrossDomainMessageHandler),r._VizManagerImpl.registerClass("tab._VizManagerImpl"),r._VizParameters.registerClass("tab._VizParameters"),r._WorkbookImpl.registerClass("tab._WorkbookImpl"),r._WorksheetImpl.registerClass("tab._WorksheetImpl",r._SheetImpl),r.JsonUtil.registerClass("tab.JsonUtil"),i.CustomView.registerClass("tableauSoftware.CustomView"),r.TableauEvent.registerClass("tab.TableauEvent"),r.CustomViewEvent.registerClass("tab.CustomViewEvent",r.TableauEvent),r.EventContext.registerClass("tab.EventContext"),r._customViewEventContext.registerClass("tab._customViewEventContext",r.EventContext),i.Sheet.registerClass("tableauSoftware.Sheet"),i.Dashboard.registerClass("tableauSoftware.Dashboard",i.Sheet),i.DashboardObject.registerClass("tableauSoftware.DashboardObject"),i.DataSource.registerClass("tableauSoftware.DataSource"),i.Field.registerClass("tableauSoftware.Field"),i.Filter.registerClass("tableauSoftware.Filter"),i.CategoricalFilter.registerClass("tableauSoftware.CategoricalFilter",i.Filter),r.WorksheetEvent.registerClass("tab.WorksheetEvent",r.TableauEvent),r.FilterEvent.registerClass("tab.FilterEvent",r.WorksheetEvent),r._filterEventContext.registerClass("tab._filterEventContext",r.EventContext),i.HierarchicalFilter.registerClass("tableauSoftware.HierarchicalFilter",i.Filter),i.QuantitativeFilter.registerClass("tableauSoftware.QuantitativeFilter",i.Filter),i.RelativeDateFilter.registerClass("tableauSoftware.RelativeDateFilter",i.Filter),r.FirstVizSizeKnownEvent.registerClass("tab.FirstVizSizeKnownEvent",r.TableauEvent),i.Version.registerClass("tableauSoftware.Version"),r.VizResizeEvent.registerClass("tab.VizResizeEvent",r.TableauEvent),i.Mark.registerClass("tableauSoftware.Mark"),r.MarksEvent.registerClass("tab.MarksEvent",r.WorksheetEvent),r._marksEventContext.registerClass("tab._marksEventContext",r.EventContext),i.Pair.registerClass("tableauSoftware.Pair"),i.Parameter.registerClass("tableauSoftware.Parameter"),r.ParameterEvent.registerClass("tab.ParameterEvent",r.TableauEvent),r._parameterEventContext.registerClass("tab._parameterEventContext",r.EventContext),i.SheetInfo.registerClass("tableauSoftware.SheetInfo"),r.SheetSizeFactory.registerClass("tab.SheetSizeFactory"),i.Story.registerClass("tableauSoftware.Story",i.Sheet),i.StoryPoint.registerClass("tableauSoftware.StoryPoint"),i.StoryPointInfo.registerClass("tableauSoftware.StoryPointInfo"),r.StoryPointSwitchEvent.registerClass("tab.StoryPointSwitchEvent",r.TableauEvent),r.TabSwitchEvent.registerClass("tab.TabSwitchEvent",r.TableauEvent),i.Viz.registerClass("tableauSoftware.Viz"),i.VizManager.registerClass("tableauSoftware.VizManager"),i.Workbook.registerClass("tableauSoftware.Workbook"),i.Worksheet.registerClass("tableauSoftware.Worksheet",i.Sheet),r._jQueryShim.registerClass("tab._jQueryShim"),r._ApiCommand.crossDomainEventNotificationId="xdomainSourceId",r._ApiCommand.lastRequestMessage=null,r._ApiCommand.lastResponseMessage=null,r._ApiCommand.lastClientInfoResponseMessage=null,r._ApiObjectRegistry._creationRegistry=null,r._ApiObjectRegistry._singletonInstanceRegistry=null,r._SheetImpl.noZoneId=4294967295,r._VizManagerImpl._vizs=[],r._WorksheetImpl._regexHierarchicalFieldName$1=new RegExp("\\[[^\\]]+\\]\\.","g"),i.Version._currentVersion=new i.Version(2,0,0,null),r._jQueryShim._class2type={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},r._jQueryShim._trim=String.prototype.trim,r._jQueryShim._toString=Object.prototype.toString,r._jQueryShim._trimLeft=new RegExp("^[\\s\\xA0]+"),r._jQueryShim._trimRight=new RegExp("[\\s\\xA0]+$"),r._jQueryShim._rvalidchars=new RegExp("^[\\],:{}\\s]*$"),r._jQueryShim._rvalidescape=new RegExp('\\\\(?:["\\\\\\/bfnrt]|u[0-9a-fA-F]{4})',"g"),r._jQueryShim._rvalidtokens=new RegExp('"[^"\\\\\\n\\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?',"g"),r._jQueryShim._rvalidbraces=new RegExp("(?:^|:|,)(?:\\s*\\[)+","g"),i.Promise=r._PromiseImpl,r._Deferred=r._DeferredImpl,r._Collection=r._CollectionImpl,i.DashboardObjectType={BLANK:"blank",WORKSHEET:"worksheet",QUICK_FILTER:"quickFilter",PARAMETER_CONTROL:"parameterControl",PAGE_FILTER:"pageFilter",LEGEND:"legend",TITLE:"title",TEXT:"text",IMAGE:"image",WEB_PAGE:"webPage"},i.FilterType={CATEGORICAL:"categorical",QUANTITATIVE:"quantitative",HIERARCHICAL:"hierarchical",RELATIVEDATE:"relativedate"},i.ParameterDataType={FLOAT:"float",INTEGER:"integer",STRING:"string",BOOLEAN:"boolean",DATE:"date",DATETIME:"datetime"},i.ParameterAllowableValuesType={ALL:"all",LIST:"list",RANGE:"range"},i.PeriodType={YEAR:"year",QUARTER:"quarter",MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTE:"minute",SECOND:"second"},i.DateRangeType={LAST:"last",LASTN:"lastn",NEXT:"next",NEXTN:"nextn",CURR:"curr",TODATE:"todate"},i.SheetSizeBehavior={AUTOMATIC:"automatic",EXACTLY:"exactly",RANGE:"range",ATLEAST:"atleast",ATMOST:"atmost"},i.SheetType={WORKSHEET:"worksheet",DASHBOARD:"dashboard",STORY:"story"},i.FilterUpdateType={ALL:"all",REPLACE:"replace",ADD:"add",REMOVE:"remove"},i.SelectionUpdateType={REPLACE:"replace",ADD:"add",REMOVE:"remove"},i.NullOption={NULL_VALUES:"nullValues",NON_NULL_VALUES:"nonNullValues",ALL_VALUES:"allValues"},i.ErrorCode={INTERNAL_ERROR:"internalError",SERVER_ERROR:"serverError",INVALID_AGGREGATION_FIELD_NAME:"invalidAggregationFieldName",INVALID_PARAMETER:"invalidParameter",INVALID_URL:"invalidUrl",STALE_DATA_REFERENCE:"staleDataReference",VIZ_ALREADY_IN_MANAGER:"vizAlreadyInManager",NO_URL_OR_PARENT_ELEMENT_NOT_FOUND:"noUrlOrParentElementNotFound",INVALID_FILTER_FIELDNAME:"invalidFilterFieldName",INVALID_FILTER_FIELDVALUE:"invalidFilterFieldValue",INVALID_FILTER_FIELDNAME_OR_VALUE:"invalidFilterFieldNameOrValue",FILTER_CANNOT_BE_PERFORMED:"filterCannotBePerformed",NOT_ACTIVE_SHEET:"notActiveSheet",INVALID_CUSTOM_VIEW_NAME:"invalidCustomViewName",MISSING_RANGEN_FOR_RELATIVE_DATE_FILTERS:"missingRangeNForRelativeDateFilters",MISSING_MAX_SIZE:"missingMaxSize",MISSING_MIN_SIZE:"missingMinSize",MISSING_MINMAX_SIZE:"missingMinMaxSize",INVALID_SIZE:"invalidSize",INVALID_SIZE_BEHAVIOR_ON_WORKSHEET:"invalidSizeBehaviorOnWorksheet",SHEET_NOT_IN_WORKBOOK:"sheetNotInWorkbook",INDEX_OUT_OF_RANGE:"indexOutOfRange",DOWNLOAD_WORKBOOK_NOT_ALLOWED:"downloadWorkbookNotAllowed",NULL_OR_EMPTY_PARAMETER:"nullOrEmptyParameter",BROWSER_NOT_CAPABLE:"browserNotCapable",UNSUPPORTED_EVENT_NAME:"unsupportedEventName",INVALID_DATE_PARAMETER:"invalidDateParameter",INVALID_SELECTION_FIELDNAME:"invalidSelectionFieldName",INVALID_SELECTION_VALUE:"invalidSelectionValue",INVALID_SELECTION_DATE:"invalidSelectionDate",NO_URL_FOR_HIDDEN_WORKSHEET:"noUrlForHiddenWorksheet",MAX_VIZ_RESIZE_ATTEMPTS:"maxVizResizeAttempts"},i.TableauEventName={CUSTOM_VIEW_LOAD:"customviewload",CUSTOM_VIEW_REMOVE:"customviewremove",CUSTOM_VIEW_SAVE:"customviewsave",CUSTOM_VIEW_SET_DEFAULT:"customviewsetdefault",FILTER_CHANGE:"filterchange",FIRST_INTERACTIVE:"firstinteractive",FIRST_VIZ_SIZE_KNOWN:"firstvizsizeknown",MARKS_SELECTION:"marksselection",PARAMETER_VALUE_CHANGE:"parametervaluechange",STORY_POINT_SWITCH:"storypointswitch",TAB_SWITCH:"tabswitch",VIZ_RESIZE:"vizresize"},i.FieldRoleType={DIMENSION:"dimension",MEASURE:"measure",UNKNOWN:"unknown"},i.FieldAggregationType={SUM:"SUM",AVG:"AVG",MIN:"MIN",MAX:"MAX",STDEV:"STDEV",STDEVP:"STDEVP",VAR:"VAR",VARP:"VARP",COUNT:"COUNT",COUNTD:"COUNTD",MEDIAN:"MEDIAN",ATTR:"ATTR",NONE:"NONE",PERCENTILE:"PERCENTILE",YEAR:"YEAR",QTR:"QTR",MONTH:"MONTH",DAY:"DAY",HOUR:"HOUR",MINUTE:"MINUTE",SECOND:"SECOND",WEEK:"WEEK",WEEKDAY:"WEEKDAY",MONTHYEAR:"MONTHYEAR",MDY:"MDY",END:"END",TRUNC_YEAR:"TRUNC_YEAR",TRUNC_QTR:"TRUNC_QTR",TRUNC_MONTH:"TRUNC_MONTH",TRUNC_WEEK:"TRUNC_WEEK",TRUNC_DAY:"TRUNC_DAY",TRUNC_HOUR:"TRUNC_HOUR",TRUNC_MINUTE:"TRUNC_MINUTE",TRUNC_SECOND:"TRUNC_SECOND",QUART1:"QUART1",QUART3:"QUART3",SKEWNESS:"SKEWNESS",KURTOSIS:"KURTOSIS",INOUT:"INOUT",SUM_XSQR:"SUM_XSQR",USER:"USER"},i.ToolbarPosition={TOP:"top",BOTTOM:"bottom"},function(){for(var e in n)if(n.hasOwnProperty(e)){var i=n[e],r=i.isPrototype?t.prototype:t;i.func?r[e]=i.func:delete r[e]}}(),r._ApiBootstrap.initialize()}(),e.exports=i}}]);
//# sourceMappingURL=605f879c-97533f469eefe80a07ec.js.map